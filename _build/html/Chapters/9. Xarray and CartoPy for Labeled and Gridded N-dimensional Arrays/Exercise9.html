
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercise 9 Xarray and CartoPy: Sea-surface height and red tides &#8212; Environmental Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapters/9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays/Exercise9';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Intro to Google Earth Engine" href="../10.%20Intro%20to%20Google%20Earth%20Engine/10.0-%20Intro%20to%20GEE.html" />
    <link rel="prev" title="Lesson 28: CartoPy Basics" href="cartopy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Environmental Data Science - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Environmental Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    EGN 4930 / EGN 5932C Special Topic: Environmental Data Science
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">0. Good Coding Practices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../0.0.%20Good%20Coding%20Practices/GCP1_VariableName.html">GCP1 - Selecting “good” variable names</a></li>

<li class="toctree-l1"><a class="reference internal" href="../0.0.%20Good%20Coding%20Practices/GCP2_DescribingCode.html">Describing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0.0.%20Good%20Coding%20Practices/GCP3_ReadableCode.html">Readable Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0.0.%20Good%20Coding%20Practices/GCP4_WritingScripts.html">Writing Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0.0.%20Good%20Coding%20Practices/GCP5_Assertions.html">Assertions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">1. Introduction to Environmental Data Science with Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1.%20Introduction%20to%20Environmental%20Data%20Science%20with%20Python/Lesson1.html">Lesson 1 - Introduction to Environmental Data Science with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1.%20Introduction%20to%20Environmental%20Data%20Science%20with%20Python/Lesson2.html">Lesson 2 Getting Started</a></li>


<li class="toctree-l1"><a class="reference internal" href="../1.%20Introduction%20to%20Environmental%20Data%20Science%20with%20Python/Excercise1.html">Exercise 1 - Installing Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2. Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2.%20Python%20Basics/Lesson3_PythonBasics1.html">Lesson 3 - Python Basics 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2.%20Python%20Basics/Lesson4_list_solution.html">Lesson 4 - Python Basics 2 - Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2.%20Python%20Basics/Lesson5_formatting.html">Lesson 5 - Python Basics 3 - Formatting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3. Python Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../3.%20Python%20Programming/Lesson6_Loops.html">Lesson 6 - Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3.%20Python%20Programming/Lesson7_conditional_statements.html">Lesson 7 - Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3.%20Python%20Programming/Lesson8_functions.html">Lesson 8 - Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3.%20Python%20Programming/Lesson9_modules.html">Lesson 9 - Script Files and Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3.%20Python%20Programming/Exercise3.html">Exercise 3 - Python Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text"> 4. Pandas for Tabular Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../%204.%20Pandas%20for%20Tabular%20Data/Lesson10_pandas.html">Lessons 10 - 14 - Pandas Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%204.%20Pandas%20for%20Tabular%20Data/Exercise4.html">Exercise 4 - Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">5. Artificial intelligence (AI) Coding Assistance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../5.%20Artificial%20intelligence%20%28AI%29%20Coding%20Assistance/OpenAI_API_Key_for_Jupyter_AI_Extension.html">OpenAI API key for Jupyter AI extension (Optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.%20Artificial%20intelligence%20%28AI%29%20Coding%20Assistance/AIcoding.html">Lesson 15 AI coding assistance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.%20Artificial%20intelligence%20%28AI%29%20Coding%20Assistance/Exercise_5_API_Key_Module.html">Exercise 5 - API-Key Module (Optional)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">6. Data Science Workflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../6.%20Data%20Science%20Workflow/Workflow.html">Lessons 16 - Data Science Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6.%20Data%20Science%20Workflow/Exercise6.html">Exercise 6 - AQI Data Preparation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">7. NumPy for Scientific Computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../7.%20NumPy%20for%20Scientific%20Computing%20%207.%20NumPy%20for%20Scientific%20Computing/numpy.html">Lessons 18-19 - NumPy Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7.%20NumPy%20for%20Scientific%20Computing%20%207.%20NumPy%20for%20Scientific%20Computing/exercise7.html">Exercise 7 - NumPy - Air quality data analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">8. Matplotlib for Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../8.%20Matplotlib%20for%20Visualization%20%208.%20Matplotlib%20for%20Visualization/matplotlib.html">Lesson 20 - 21 - Matplotlib Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../8.%20Matplotlib%20for%20Visualization%20%208.%20Matplotlib%20for%20Visualization/exercise8.html">Exercise 8 Matplotlib - Air quality data visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text"> 9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="climate.html">Lesson 24 - Climate Data - CMIP6 and Remote Sensing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray.html">Lesson 25-27 - Xarray basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartopy.html">Lesson 28 - CartoPy basics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercise 9 - Sea surface height and red tides (Optional, Advanced)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">10. Introduction to Google Earth Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../10.%20Intro%20to%20Google%20Earth%20Engine/10.0-%20Intro%20to%20GEE.html">Lesson 30 - Intro to Google Earth Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10.%20Intro%20to%20Google%20Earth%20Engine/10.1-%20JavaScript%20API%20vs.%20Python%20API.html">Lesson 31 - JavaScript API vs. Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10.%20Intro%20to%20Google%20Earth%20Engine/10.2-%20Using%20Google%20Earth%20Engine%20in%20a%20Jupyter%20Notebook.html">Lesson 32 - Using Google Earth Engine in a Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10.%20Intro%20to%20Google%20Earth%20Engine/geemap1.html">Exercise 10 -  GeeMap, GEE, and Sentinel-2 Data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Chapters/9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays/Exercise9.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapters/9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays/Exercise9.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Chapters/9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays/Exercise9.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise 9 Xarray and CartoPy: Sea-surface height and red tides</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-statement">1. Problem Statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-sla-data">2. Exploring SLA data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-global-data-optional">2.1 Download global data (<em>optional</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-and-save-gulf-of-mexico-data-optional">2.2 Select and save Gulf of Mexico data (<em>optional</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-display-data">2.3 Load and display data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-cooridnates-along-trackline-26">2.4 Generate cooridnates along trackline 26</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-trackline">2.5 Plot trackline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-sla-data-along-trackline-26">2.6 Extract SLA data along trackline 26</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-sla-data-along-trackline-26">2.7 Plot SLA data along trackline 26</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-k-brevis-data">3. Exploring K. brevis data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-k-brevis-data-for-west-florida-shielf">3.1 Extract K. brevis data for West Florida shielf</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-3d-daily-k-brevis-data-to-1d-weekly-data">3.2 Transform 3d daily K. brevis data to 1d weekly data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-weekly-k-brevis-data">3.3 Plot weekly K. brevis data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-sla-and-k-brevis-to-prepare-data-for-analysis">4. Transform SLA and K. brevis to prepare data for analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-resolution-alignment-of-sla-and-k-brevis-data">4.1 Temporal resolution alignment of SLA and k. brevis data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-2d-time-series-of-sla-along-trackline-26-to-1d-time-series">4.2 Reduce 2D time series of SLA along trackline-26 to 1d time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-steps">4.3 Additional steps</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-9-xarray-and-cartopy-sea-surface-height-and-red-tides">
<h1>Exercise 9 Xarray and CartoPy: Sea-surface height and red tides<a class="headerlink" href="#exercise-9-xarray-and-cartopy-sea-surface-height-and-red-tides" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://mybinder.org/v2/gh/aselshall/eds/HEAD"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pip install cdsapi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pip install statsmodels</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>

<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1">#  Suppress warnings issued by Cartopy when downloading data files</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;xarray&#39;
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="problem-statement">
<h2>1. Problem Statement<a class="headerlink" href="#problem-statement" title="Link to this heading">#</a></h2>
<p>The hypothesis is that high sea-level anomalies in the Gulf of Mexico is a  a necessary condition for the occurance of red tides (high concentration of K. brevis cell counts) in the West Florida shielf. High sea-level anomalies is asscoiated with the Gulf Loop Current, which is a warm ocean current that flows from the Caribbean to the Gulf of Mexico, then loops east and south along the Florida coast, and exits through the Straits of Florida. To investigate the relationship between sea level anomalies (SLA) and red tide occurrences (K. brevis cell counts), we you can employ several statistical methods such as time series analysis, regression analysis, event study analysis, spatial correlation analysis and machine learning models. The objective of this exercise is to prepare data for analysis. Specifically, our tasks are to:</p>
<ul class="simple">
<li><p>download and reduce monthly 3d (x,y, time) SLA data to monthly 2d (x, time) data</p></li>
<li><p>download and reduce daily 3d (x,y, time) K. brevis data to weekly 1d (time) data</p></li>
<li><p>Redue monthly 2D (x, time) sla data into to weekly 1d (time) data with temporal alignment with K. brevis data</p></li>
<li><p>transform weekly 1d SLA and K. brevs data with techniques for stationarity, detrending, zero mean, normalization, etc.</p></li>
</ul>
<p>This is all needed so the we you can directly compare SLA data with K. brevis cell count data and perform statstical analysis.</p>
</section>
<section id="exploring-sla-data">
<h2>2. Exploring SLA data<a class="headerlink" href="#exploring-sla-data" title="Link to this heading">#</a></h2>
<section id="download-global-data-optional">
<h3>2.1 Download global data (<em>optional</em>)<a class="headerlink" href="#download-global-data-optional" title="Link to this heading">#</a></h3>
<p>From <a class="reference external" href="https://cds.climate.copernicus.eu/#!/home">Climate Data Store (CDS)</a> you can download the <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-sea-level-globa">Sea level gridded data from satellite observations for the global ocean from 1993 to present</a>. You can manually download the data from CDS website or through API. This <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to#install-the-cds-api-ke">link</a> contains information on how to use the CDS API and API key. Additional information can be found in this <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/How+to+install+and+use+CDS+API+on+Windows">link</a>.</p>
<p>To run the code below, you need first to set the CDS API key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import cdsapi</span>

<span class="c1"># c = cdsapi.Client()</span>

<span class="c1"># c.retrieve(</span>
<span class="c1">#     &#39;satellite-sea-level-global&#39;,</span>
<span class="c1">#     {</span>
<span class="c1">#         &#39;version&#39;: &#39;vDT2021&#39;,</span>
<span class="c1">#         &#39;format&#39;: &#39;zip&#39;,</span>
<span class="c1">#         &#39;variable&#39;: &#39;monthly_mean&#39;,</span>
<span class="c1">#         &#39;year&#39;: [</span>
<span class="c1">#             &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;,</span>
<span class="c1">#             &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;,</span>
<span class="c1">#             &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;,</span>
<span class="c1">#             &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;,</span>
<span class="c1">#             &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;,</span>
<span class="c1">#             &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;,</span>
<span class="c1">#             &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;,</span>
<span class="c1">#             &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;,</span>
<span class="c1">#             &#39;2017&#39;, &#39;2018&#39;, &#39;2019&#39;,</span>
<span class="c1">#             &#39;2020&#39;, &#39;2021&#39;, &#39;2022&#39;,</span>
<span class="c1">#             &#39;2023&#39;,</span>
<span class="c1">#         ],</span>
<span class="c1">#         &#39;month&#39;: [</span>
<span class="c1">#             &#39;01&#39;, &#39;02&#39;, &#39;03&#39;,</span>
<span class="c1">#             &#39;04&#39;, &#39;05&#39;, &#39;06&#39;,</span>
<span class="c1">#             &#39;07&#39;, &#39;08&#39;, &#39;09&#39;,</span>
<span class="c1">#             &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,</span>
<span class="c1">#         ],</span>
<span class="c1">#     },</span>
<span class="c1">#     &#39;download.zip&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-and-save-gulf-of-mexico-data-optional">
<h3>2.2 Select and save Gulf of Mexico data (<em>optional</em>)<a class="headerlink" href="#select-and-save-gulf-of-mexico-data-optional" title="Link to this heading">#</a></h3>
<p>We need to extract the Gulf of Mexico data from this global dataset as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Read all files</span>
<span class="c1"># ds = xr.open_mfdataset(&quot;Data/zos/hist/global/*.nc&quot;, combine=&quot;by_coords&quot;)  # , parallel=True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Display dataset</span>
<span class="c1"># ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ds.attrs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # label-based selection to extract &#39;sla&#39; data from the &#39;ds&#39; DataSet.</span>
<span class="c1"># subset=ds.sla.sel(</span>
<span class="c1">#     latitude=slice(18,32), # South to North</span>
<span class="c1">#     longitude=slice(360-100, 360-75)) #West to East</span>

<span class="c1"># # Display slice </span>
<span class="c1"># plt.figure(figsize=(10, 6))</span>
<span class="c1"># ax = plt.axes(projection=ccrs.PlateCarree())</span>
<span class="c1"># subset[0,:,:].plot()</span>
<span class="c1"># ax.coastlines()</span>

<span class="c1"># # Write the DataArray to a netCDF file</span>
<span class="c1"># subset.to_netcdf(&#39;Data/zos/hist/dt_FL_twosat_phy_l4_199303_202305_vDT2021-M01.nc&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-and-display-data">
<h3>2.3 Load and display data<a class="headerlink" href="#load-and-display-data" title="Link to this heading">#</a></h3>
<p>Load SLA data in the Gulf of Mexico from 1993-03 to 2023-05. The data file is provided with this exercise, so you do not need to use the codes in Sections 2.1 and 2.2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the netCDF file into a DataArray</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;Data/zos/hist/dt_FL_twosat_phy_l4_199303_202305_vDT2021-M01.nc&#39;</span><span class="p">)</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 16MB
Dimensions:    (time: 364, latitude: 56, longitude: 100)
Coordinates:
  * time       (time) datetime64[ns] 3kB 1993-02-15 1993-03-15 ... 2023-05-15
  * latitude   (latitude) float32 224B 18.12 18.38 18.62 ... 31.38 31.62 31.88
  * longitude  (longitude) float32 400B 260.1 260.4 260.6 ... 284.4 284.6 284.9
Data variables:
    sla        (time, latitude, longitude) float64 16MB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e851bd39-a8d6-401f-9f0d-0cb08e3365eb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e851bd39-a8d6-401f-9f0d-0cb08e3365eb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 364</li><li><span class='xr-has-index'>latitude</span>: 56</li><li><span class='xr-has-index'>longitude</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d5b8dcb2-004c-4006-a2c5-c2425539261a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d5b8dcb2-004c-4006-a2c5-c2425539261a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-15 ... 2023-05-15</div><input id='attrs-819f20d6-ded6-4d53-ab3a-1d701c383d01' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-819f20d6-ded6-4d53-ab3a-1d701c383d01' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c75cf51-fdc9-4d04-80fb-39ae04394309' class='xr-var-data-in' type='checkbox'><label for='data-6c75cf51-fdc9-4d04-80fb-39ae04394309' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-15T00:00:00.000000000&#x27;, &#x27;1993-03-15T00:00:00.000000000&#x27;,
       &#x27;1993-04-15T00:00:00.000000000&#x27;, ..., &#x27;2023-03-15T00:00:00.000000000&#x27;,
       &#x27;2023-04-15T00:00:00.000000000&#x27;, &#x27;2023-05-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>18.12 18.38 18.62 ... 31.62 31.88</div><input id='attrs-b03c8739-1329-4cc2-814e-60fd233c3484' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b03c8739-1329-4cc2-814e-60fd233c3484' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c2afab0-e4a4-424a-be0c-152ff7015752' class='xr-var-data-in' type='checkbox'><label for='data-8c2afab0-e4a4-424a-be0c-152ff7015752' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_max :</span></dt><dd>89.875</dd><dt><span>valid_min :</span></dt><dd>-89.875</dd></dl></div><div class='xr-var-data'><pre>array([18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125,
       20.375, 20.625, 20.875, 21.125, 21.375, 21.625, 21.875, 22.125, 22.375,
       22.625, 22.875, 23.125, 23.375, 23.625, 23.875, 24.125, 24.375, 24.625,
       24.875, 25.125, 25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875,
       27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>260.1 260.4 260.6 ... 284.6 284.9</div><input id='attrs-f4d6eb55-01a0-4d38-9231-c6d97a904d5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f4d6eb55-01a0-4d38-9231-c6d97a904d5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3adafc59-008b-4004-8098-7fec99430b8e' class='xr-var-data-in' type='checkbox'><label for='data-3adafc59-008b-4004-8098-7fec99430b8e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_max :</span></dt><dd>359.875</dd><dt><span>valid_min :</span></dt><dd>0.125</dd></dl></div><div class='xr-var-data'><pre>array([260.125, 260.375, 260.625, 260.875, 261.125, 261.375, 261.625, 261.875,
       262.125, 262.375, 262.625, 262.875, 263.125, 263.375, 263.625, 263.875,
       264.125, 264.375, 264.625, 264.875, 265.125, 265.375, 265.625, 265.875,
       266.125, 266.375, 266.625, 266.875, 267.125, 267.375, 267.625, 267.875,
       268.125, 268.375, 268.625, 268.875, 269.125, 269.375, 269.625, 269.875,
       270.125, 270.375, 270.625, 270.875, 271.125, 271.375, 271.625, 271.875,
       272.125, 272.375, 272.625, 272.875, 273.125, 273.375, 273.625, 273.875,
       274.125, 274.375, 274.625, 274.875, 275.125, 275.375, 275.625, 275.875,
       276.125, 276.375, 276.625, 276.875, 277.125, 277.375, 277.625, 277.875,
       278.125, 278.375, 278.625, 278.875, 279.125, 279.375, 279.625, 279.875,
       280.125, 280.375, 280.625, 280.875, 281.125, 281.375, 281.625, 281.875,
       282.125, 282.375, 282.625, 282.875, 283.125, 283.375, 283.625, 283.875,
       284.125, 284.375, 284.625, 284.875], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fd2599e5-d2ec-49ec-b8c5-9927ced42b7b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fd2599e5-d2ec-49ec-b8c5-9927ced42b7b' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sla</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-747969af-3ccd-4b1f-9164-4ac69059ff4c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-747969af-3ccd-4b1f-9164-4ac69059ff4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a2f2f99-2b8d-49a1-98df-df51704c57c2' class='xr-var-data-in' type='checkbox'><label for='data-7a2f2f99-2b8d-49a1-98df-df51704c57c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean within years</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Averaged Sea Level Anomalies 1993/02</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>[2038400 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-614ba5fc-4b3b-4af0-9e0a-ec1cc0e13643' class='xr-section-summary-in' type='checkbox'  ><label for='section-614ba5fc-4b3b-4af0-9e0a-ec1cc0e13643' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-18b88a68-5db2-4414-9c3b-0865d71fa41c' class='xr-index-data-in' type='checkbox'/><label for='index-18b88a68-5db2-4414-9c3b-0865d71fa41c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-15&#x27;, &#x27;1993-03-15&#x27;, &#x27;1993-04-15&#x27;, &#x27;1993-05-15&#x27;,
               &#x27;1993-06-15&#x27;, &#x27;1993-07-15&#x27;, &#x27;1993-08-15&#x27;, &#x27;1993-09-15&#x27;,
               &#x27;1993-10-15&#x27;, &#x27;1993-11-15&#x27;,
               ...
               &#x27;2022-08-15&#x27;, &#x27;2022-09-15&#x27;, &#x27;2022-10-15&#x27;, &#x27;2022-11-15&#x27;,
               &#x27;2022-12-15&#x27;, &#x27;2023-01-15&#x27;, &#x27;2023-02-15&#x27;, &#x27;2023-03-15&#x27;,
               &#x27;2023-04-15&#x27;, &#x27;2023-05-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=364, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ccfef5fd-21d4-458d-97ea-ff0baa6996ed' class='xr-index-data-in' type='checkbox'/><label for='index-ccfef5fd-21d4-458d-97ea-ff0baa6996ed' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125,
       20.375, 20.625, 20.875, 21.125, 21.375, 21.625, 21.875, 22.125, 22.375,
       22.625, 22.875, 23.125, 23.375, 23.625, 23.875, 24.125, 24.375, 24.625,
       24.875, 25.125, 25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875,
       27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-339f434f-6b6c-4072-b80d-1e86f02d57fc' class='xr-index-data-in' type='checkbox'/><label for='index-339f434f-6b6c-4072-b80d-1e86f02d57fc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([260.125, 260.375, 260.625, 260.875, 261.125, 261.375, 261.625, 261.875,
       262.125, 262.375, 262.625, 262.875, 263.125, 263.375, 263.625, 263.875,
       264.125, 264.375, 264.625, 264.875, 265.125, 265.375, 265.625, 265.875,
       266.125, 266.375, 266.625, 266.875, 267.125, 267.375, 267.625, 267.875,
       268.125, 268.375, 268.625, 268.875, 269.125, 269.375, 269.625, 269.875,
       270.125, 270.375, 270.625, 270.875, 271.125, 271.375, 271.625, 271.875,
       272.125, 272.375, 272.625, 272.875, 273.125, 273.375, 273.625, 273.875,
       274.125, 274.375, 274.625, 274.875, 275.125, 275.375, 275.625, 275.875,
       276.125, 276.375, 276.625, 276.875, 277.125, 277.375, 277.625, 277.875,
       278.125, 278.375, 278.625, 278.875, 279.125, 279.375, 279.625, 279.875,
       280.125, 280.375, 280.625, 280.875, 281.125, 281.375, 281.625, 281.875,
       282.125, 282.375, 282.625, 282.875, 283.125, 283.375, 283.625, 283.875,
       284.125, 284.375, 284.625, 284.875],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c22a475b-bb96-484b-b559-ce2ba1db08f2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c22a475b-bb96-484b-b559-ce2ba1db08f2' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display 2d data  at the first time step</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4fa02fffa28767e717b8947f32795eb1ecd62b81d15e5803b68a57bf15538aaa.png" src="../../_images/4fa02fffa28767e717b8947f32795eb1ecd62b81d15e5803b68a57bf15538aaa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean SLA across the &#39;latitude&#39; and &#39;longitude&#39; dimensions</span>
<span class="n">mean_sla</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dc18be91eb06b59105d8f772ee0fd1e324b39b052001dc3051914e876d0d7ae4.png" src="../../_images/dc18be91eb06b59105d8f772ee0fd1e324b39b052001dc3051914e876d0d7ae4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Let us learn more about SLA</span>
<span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;cell_methods&#39;: &#39;time: mean within years&#39;,
 &#39;grid_mapping&#39;: &#39;crs&#39;,
 &#39;long_name&#39;: &#39;Averaged Sea Level Anomalies 1993/02&#39;,
 &#39;standard_name&#39;: &#39;sea_surface_height_above_sea_level&#39;,
 &#39;units&#39;: &#39;m&#39;}
</pre></div>
</div>
</div>
</div>
<p>The above DataSet <code class="docutils literal notranslate"><span class="pre">ds</span></code> is monthly. Let us increase temporal resolution to weekly using interpolation <code class="docutils literal notranslate"><span class="pre">.interp</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new time coordinate with weekly frequency</span>
<span class="n">weekly_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

<span class="c1"># Interpolate the DataArray to weekly values</span>
<span class="n">ds_weekly</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">weekly_dates</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Plot our high temporal resolution data</span>
<span class="n">ds_weekly</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Display our high temporal resolution data</span>
<span class="n">ds_weekly</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 71MB
Dimensions:    (latitude: 56, longitude: 100, time: 1578)
Coordinates:
  * latitude   (latitude) float32 224B 18.12 18.38 18.62 ... 31.38 31.62 31.88
  * longitude  (longitude) float32 400B 260.1 260.4 260.6 ... 284.4 284.6 284.9
  * time       (time) datetime64[ns] 13kB 1993-02-21 1993-02-28 ... 2023-05-14
Data variables:
    sla        (time, latitude, longitude) float64 71MB nan nan ... 0.06263</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0a8827c0-adca-48b6-8c14-ce8eb4b19467' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0a8827c0-adca-48b6-8c14-ce8eb4b19467' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 56</li><li><span class='xr-has-index'>longitude</span>: 100</li><li><span class='xr-has-index'>time</span>: 1578</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5fd3fb11-6659-4f39-bc59-0e852f41b59b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5fd3fb11-6659-4f39-bc59-0e852f41b59b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>18.12 18.38 18.62 ... 31.62 31.88</div><input id='attrs-6dd69ada-8d9b-4433-8c4e-809cd17aa930' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6dd69ada-8d9b-4433-8c4e-809cd17aa930' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3a2732d-f3c3-48e4-b9d0-6837d7d40ce1' class='xr-var-data-in' type='checkbox'><label for='data-a3a2732d-f3c3-48e4-b9d0-6837d7d40ce1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_max :</span></dt><dd>89.875</dd><dt><span>valid_min :</span></dt><dd>-89.875</dd></dl></div><div class='xr-var-data'><pre>array([18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125,
       20.375, 20.625, 20.875, 21.125, 21.375, 21.625, 21.875, 22.125, 22.375,
       22.625, 22.875, 23.125, 23.375, 23.625, 23.875, 24.125, 24.375, 24.625,
       24.875, 25.125, 25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875,
       27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>260.1 260.4 260.6 ... 284.6 284.9</div><input id='attrs-bf306cdc-3177-42b4-b743-c4875c76d9dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf306cdc-3177-42b4-b743-c4875c76d9dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f852928-22e2-4a62-a382-a14819f0cba7' class='xr-var-data-in' type='checkbox'><label for='data-1f852928-22e2-4a62-a382-a14819f0cba7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_max :</span></dt><dd>359.875</dd><dt><span>valid_min :</span></dt><dd>0.125</dd></dl></div><div class='xr-var-data'><pre>array([260.125, 260.375, 260.625, 260.875, 261.125, 261.375, 261.625, 261.875,
       262.125, 262.375, 262.625, 262.875, 263.125, 263.375, 263.625, 263.875,
       264.125, 264.375, 264.625, 264.875, 265.125, 265.375, 265.625, 265.875,
       266.125, 266.375, 266.625, 266.875, 267.125, 267.375, 267.625, 267.875,
       268.125, 268.375, 268.625, 268.875, 269.125, 269.375, 269.625, 269.875,
       270.125, 270.375, 270.625, 270.875, 271.125, 271.375, 271.625, 271.875,
       272.125, 272.375, 272.625, 272.875, 273.125, 273.375, 273.625, 273.875,
       274.125, 274.375, 274.625, 274.875, 275.125, 275.375, 275.625, 275.875,
       276.125, 276.375, 276.625, 276.875, 277.125, 277.375, 277.625, 277.875,
       278.125, 278.375, 278.625, 278.875, 279.125, 279.375, 279.625, 279.875,
       280.125, 280.375, 280.625, 280.875, 281.125, 281.375, 281.625, 281.875,
       282.125, 282.375, 282.625, 282.875, 283.125, 283.375, 283.625, 283.875,
       284.125, 284.375, 284.625, 284.875], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-21 ... 2023-05-14</div><input id='attrs-69a8eea3-b6f2-4fab-a8df-8b8e4024f558' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-69a8eea3-b6f2-4fab-a8df-8b8e4024f558' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bbe23c9f-a150-411e-aa76-cf9e2a12b634' class='xr-var-data-in' type='checkbox'><label for='data-bbe23c9f-a150-411e-aa76-cf9e2a12b634' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-21T00:00:00.000000000&#x27;, &#x27;1993-02-28T00:00:00.000000000&#x27;,
       &#x27;1993-03-07T00:00:00.000000000&#x27;, ..., &#x27;2023-04-30T00:00:00.000000000&#x27;,
       &#x27;2023-05-07T00:00:00.000000000&#x27;, &#x27;2023-05-14T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-63ec11f4-fce6-4503-abfc-1967ad9292aa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-63ec11f4-fce6-4503-abfc-1967ad9292aa' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sla</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.02337 0.06263</div><input id='attrs-4b6762b3-1992-4d7b-8bc3-76af7eaf245c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4b6762b3-1992-4d7b-8bc3-76af7eaf245c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f94b77fa-cdf2-494b-b1a1-c8ed12ddcbe7' class='xr-var-data-in' type='checkbox'><label for='data-f94b77fa-cdf2-494b-b1a1-c8ed12ddcbe7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean within years</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Averaged Sea Level Anomalies 1993/02</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[[        nan,         nan,         nan, ..., -0.03057143,
         -0.01968571, -0.00768571],
        [        nan,         nan,         nan, ..., -0.04469286,
         -0.03708571, -0.02513571],
        [        nan,         nan,         nan, ..., -0.05566429,
         -0.04693571, -0.03227143],
        ...,
        [        nan,         nan,         nan, ..., -0.03746429,
         -0.01902857,  0.0021    ],
        [        nan,         nan,         nan, ..., -0.02758571,
         -0.01547857,  0.00588571],
        [        nan,         nan,         nan, ..., -0.02715714,
         -0.02217143, -0.00744286]],

       [[        nan,         nan,         nan, ..., -0.03812143,
         -0.02853571, -0.01723571],
        [        nan,         nan,         nan, ..., -0.04631786,
         -0.03823571, -0.02716071],
        [        nan,         nan,         nan, ..., -0.05118929,
         -0.04231071, -0.03072143],
...
        [        nan,         nan,         nan, ...,  0.1699    ,
          0.1858    ,  0.19368   ],
        [        nan,         nan,         nan, ...,  0.10372667,
          0.09972667,  0.11971333],
        [        nan,         nan,         nan, ...,  0.03856667,
          0.02733333,  0.06634   ]],

       [[        nan,         nan,         nan, ...,  0.04847   ,
          0.04473667,  0.05235667],
        [        nan,         nan,         nan, ...,  0.03108333,
          0.03206667,  0.04758667],
        [        nan,         nan,         nan, ...,  0.02559667,
          0.03150333,  0.04904333],
        ...,
        [        nan,         nan,         nan, ...,  0.1734    ,
          0.19525   ,  0.20691   ],
        [        nan,         nan,         nan, ...,  0.11140333,
          0.10810333,  0.12862667],
        [        nan,         nan,         nan, ...,  0.03658333,
          0.02336667,  0.06263   ]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-806182ab-4170-4fb8-b206-673bc4f12368' class='xr-section-summary-in' type='checkbox'  ><label for='section-806182ab-4170-4fb8-b206-673bc4f12368' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-75ca9bf3-70a4-4877-ba8b-e12be73c19fc' class='xr-index-data-in' type='checkbox'/><label for='index-75ca9bf3-70a4-4877-ba8b-e12be73c19fc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125,
       20.375, 20.625, 20.875, 21.125, 21.375, 21.625, 21.875, 22.125, 22.375,
       22.625, 22.875, 23.125, 23.375, 23.625, 23.875, 24.125, 24.375, 24.625,
       24.875, 25.125, 25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875,
       27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
       29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
       31.625, 31.875],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a5959951-51e5-4d73-b89a-272a984fc979' class='xr-index-data-in' type='checkbox'/><label for='index-a5959951-51e5-4d73-b89a-272a984fc979' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([260.125, 260.375, 260.625, 260.875, 261.125, 261.375, 261.625, 261.875,
       262.125, 262.375, 262.625, 262.875, 263.125, 263.375, 263.625, 263.875,
       264.125, 264.375, 264.625, 264.875, 265.125, 265.375, 265.625, 265.875,
       266.125, 266.375, 266.625, 266.875, 267.125, 267.375, 267.625, 267.875,
       268.125, 268.375, 268.625, 268.875, 269.125, 269.375, 269.625, 269.875,
       270.125, 270.375, 270.625, 270.875, 271.125, 271.375, 271.625, 271.875,
       272.125, 272.375, 272.625, 272.875, 273.125, 273.375, 273.625, 273.875,
       274.125, 274.375, 274.625, 274.875, 275.125, 275.375, 275.625, 275.875,
       276.125, 276.375, 276.625, 276.875, 277.125, 277.375, 277.625, 277.875,
       278.125, 278.375, 278.625, 278.875, 279.125, 279.375, 279.625, 279.875,
       280.125, 280.375, 280.625, 280.875, 281.125, 281.375, 281.625, 281.875,
       282.125, 282.375, 282.625, 282.875, 283.125, 283.375, 283.625, 283.875,
       284.125, 284.375, 284.625, 284.875],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6c625282-6a64-4b75-81d8-0d1d76ba89cd' class='xr-index-data-in' type='checkbox'/><label for='index-6c625282-6a64-4b75-81d8-0d1d76ba89cd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-21&#x27;, &#x27;1993-02-28&#x27;, &#x27;1993-03-07&#x27;, &#x27;1993-03-14&#x27;,
               &#x27;1993-03-21&#x27;, &#x27;1993-03-28&#x27;, &#x27;1993-04-04&#x27;, &#x27;1993-04-11&#x27;,
               &#x27;1993-04-18&#x27;, &#x27;1993-04-25&#x27;,
               ...
               &#x27;2023-03-12&#x27;, &#x27;2023-03-19&#x27;, &#x27;2023-03-26&#x27;, &#x27;2023-04-02&#x27;,
               &#x27;2023-04-09&#x27;, &#x27;2023-04-16&#x27;, &#x27;2023-04-23&#x27;, &#x27;2023-04-30&#x27;,
               &#x27;2023-05-07&#x27;, &#x27;2023-05-14&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1578, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0b63c302-cfed-41d9-8f13-b39eecfdfd2f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0b63c302-cfed-41d9-8f13-b39eecfdfd2f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div><img alt="../../_images/32741641a68abff456de71a49d64e818cb88ed31ffbda7709b6dd7f4f51b56b6.png" src="../../_images/32741641a68abff456de71a49d64e818cb88ed31ffbda7709b6dd7f4f51b56b6.png" />
</div>
</div>
<p>Note from monthly to weekly, the number of time cooridnates 364 to 1578.</p>
</section>
<section id="generate-cooridnates-along-trackline-26">
<h3>2.4 Generate cooridnates along trackline 26<a class="headerlink" href="#generate-cooridnates-along-trackline-26" title="Link to this heading">#</a></h3>
<p>According to <a class="reference external" href="https://doi.org/10.1016/j.hal.2014.04.010">Weisberg et al., 2014</a> we can establish a correlation between sea-level anomalies in the Gulf of Mexico and the occurrence of red tides (high concentrations of K. brevis cell counts) in the West Florida Shelf through trackine 26 with the following start and end points in the code <a class="reference external" href="http://below.To">below.To</a> increase spatial resolution, let us calculate intermediate points along the start and end points of trackine 26, and store them in a NumPy array.Let us to do 100 points along trackine 26 and find the latitude and longitudes of these 100 points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This code is generated by ChatGPT 3.5</span>
<span class="c1"># Define the start and end points</span>
<span class="n">start_point</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">85.79403277044844</span><span class="p">,</span> <span class="mf">28.44874852567387</span><span class="p">)</span>
<span class="n">end_point</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">83.61900543369907</span><span class="p">,</span> <span class="mf">23.84111494192613</span><span class="p">)</span>

<span class="c1"># Calculate the distance between the two points using Vincenty&#39;s formulae</span>
<span class="k">def</span> <span class="nf">vincenty_distance</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">):</span>
    <span class="n">earth_radius</span> <span class="o">=</span> <span class="mi">6371</span>  <span class="c1"># Earth&#39;s radius in kilometers</span>
    <span class="n">phi1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span>
    <span class="n">phi2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">delta_phi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat2</span> <span class="o">-</span> <span class="n">lat1</span><span class="p">)</span>
    <span class="n">delta_lambda</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon2</span> <span class="o">-</span> <span class="n">lon1</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_phi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_lambda</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta_lambda</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">earth_radius</span> <span class="o">*</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">distance</span>

<span class="n">total_distance</span> <span class="o">=</span> <span class="n">vincenty_distance</span><span class="p">(</span><span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Calculate intermediate points and store them in a NumPy array</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">intermediate_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Initialize a NumPy array to store the points</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_points</span><span class="p">):</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">intermediate_lat</span> <span class="o">=</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">ratio</span>
    <span class="n">intermediate_lon</span> <span class="o">=</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">ratio</span>
    <span class="n">intermediate_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">intermediate_lat</span><span class="p">,</span> <span class="n">intermediate_lon</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;intermediate_points has shape&#39;</span><span class="p">,</span> <span class="n">intermediate_points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Start point&#39;</span><span class="p">,</span><span class="n">intermediate_points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;End point&#39;</span><span class="p">,</span><span class="n">intermediate_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>intermediate_points has shape (100, 2)
Start point [-85.77249785  28.40312839]
End point [-83.64054036  23.88673508]
</pre></div>
</div>
</div>
</div>
<p>We will convert the longitude coordinates from the -180 to 180 convention to the 0 to 360 convention to make the coordinates of our 100 points along trackline 26 consistant with the SLA data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make coordinate of 100 points aling trackine 26 consistant with SLA data</span>
<span class="n">points</span><span class="o">=</span> <span class="n">intermediate_points</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">360</span> <span class="c1"># Add 360 to the first column</span>
<span class="n">points</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="c1"># Swap the columns</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;latitudes, longitudes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 2)
latitudes, longitudes
[ 28.40312839 274.22750215]
[ 23.88673508 276.35945964]
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-trackline">
<h3>2.5 Plot trackline<a class="headerlink" href="#plot-trackline" title="Link to this heading">#</a></h3>
<p>Let us plot our trackline 26 and shown the the background either SLA data or bathymetry lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 0) Select data to plot</span>
<span class="n">Plot_Num</span><span class="o">=</span> <span class="mi">2</span>  <span class="c1">#Type 1 to plot SLA data for the first time step or 2 to plot bathymetry lines</span>

<span class="c1"># 1) Select plot extend: Lon_West, Lon_East, Lat_South, Lat_North in Degrees</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span> 

<span class="c1"># 2) Select projection</span>
<span class="n">projPC</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="c1"># 3) Create figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">))</span>
<span class="c1">#plt.subplots_adjust(hspace=0.1, wspace=0.2)  # Adjust the height and width spaces between subplots</span>

<span class="c1"># 4) Loop to plot variables </span>
<span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;sla&#39;</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span>
<span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="c1"># 5) Create Axes     </span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projPC</span><span class="p">)</span>

<span class="c1"># 6) Setting the extent of the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">projPC</span><span class="p">)</span>

<span class="c1"># 7) Add plot title </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># 8) Add gridlines (we need to cutomize grid lines to improve visualization)                              </span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlocs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ylocs</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">),</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>  <span class="n">zorder</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># </span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>    <span class="c1"># Set the font size for x-axis labels</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>  <span class="c1"># Set the font size for x-axis labels</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>  <span class="c1"># Set the font size for y-axis labels</span>

<span class="c1"># 9) Adding Natural Earth features</span>
<span class="c1">## Pre-defined features</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">])</span>  <span class="c1">#Blackgroundwater color for the ocean</span>
<span class="c1">#ax.add_feature(cfeature.LAND.with_scale(&#39;10m&#39;), zorder=20) </span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="s1">&#39;10m&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;aqua&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="s1">&#39;10m&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>

<span class="c1">## General features (not pre-defined)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span>
    <span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;rivers_lake_centerlines&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span>
    <span class="s1">&#39;physical&#39;</span><span class="p">,</span><span class="s1">&#39;rivers_north_america&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># 10) Adding user-defined features </span>
<span class="c1"># Plot site area on GeoAxes given lon and lat coordinates in first subplot </span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">85.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">85.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">26.5</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">85.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.85</span><span class="p">],</span> <span class="p">[</span><span class="mf">28.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">85.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">26.5</span><span class="p">,</span> <span class="mf">26.5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1">## Plot Track 026 line on GeoAxex and annotate with text using axes cooridnates in second subplot</span>
<span class="c1">#points = np.array([[-85.7940, 28.4487], [-83.6190, 23.8411]]) </span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intermediate_points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">intermediate_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;Track 026&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>  <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>  <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>  <span class="n">rotation</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1">## Adding names and locations of major cities</span>
<span class="n">locations_coordinates</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Tampa&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">27.9506</span><span class="p">,</span> <span class="o">-</span><span class="mf">82.4572</span><span class="p">],</span> 
                     <span class="c1">#&quot;Sarasota&quot;: [27.3364, -82.5307], </span>
                     <span class="c1">#&quot;Fort Myers&quot;: [26.6406, -81.8723], </span>
                     <span class="s2">&quot;Naples&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">26.142</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.7948</span><span class="p">]}</span>
<span class="k">for</span> <span class="n">location</span><span class="p">,</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">locations_coordinates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">22</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> 
            <span class="n">location</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">22</span><span class="p">)</span>

<span class="c1"># 11) Adding raster data and colorbar for the first three subplots</span>
<span class="k">if</span> <span class="n">Plot_Num</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
    <span class="c1"># dataplot = ax.contourf(da.latitude, da.longitude, da.sla[0,:,:], </span>
    <span class="c1">#                        cmap=colormap, zorder=12, transform=ccrs.PlateCarree())</span>
    <span class="n">dataplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> 
                           <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">dataplot</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
    <span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#12) Plot 6 bathymetry lines using a loop</span>
<span class="k">if</span> <span class="n">Plot_Num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="c1"># Names of bathymetry line </span>
    <span class="n">bathymetry_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bathymetry_L_0&#39;</span><span class="p">,</span> <span class="s1">&#39;bathymetry_K_200&#39;</span><span class="p">,</span> 
                        <span class="s1">&#39;bathymetry_J_1000&#39;</span><span class="p">,</span> <span class="s1">&#39;bathymetry_I_2000&#39;</span><span class="p">,</span> 
                        <span class="s1">&#39;bathymetry_H_3000&#39;</span><span class="p">,</span> <span class="s1">&#39;bathymetry_G_4000&#39;</span><span class="p">]</span> 
    
    <span class="c1"># Very light blue to light blue generated by ChatGPT 3.5 Turbo</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
              <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
              <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">]</span>  
    
    <span class="c1"># Loop to plot each bathymetry line</span>
    <span class="k">for</span> <span class="n">bathymetry_name</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bathymetry_names</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span>
            <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span>
                <span class="n">category</span><span class="o">=</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> 
                <span class="n">name</span><span class="o">=</span><span class="n">bathymetry_name</span><span class="p">,</span> 
                <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> 
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> 
                <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">),</span> 
            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/98a38ae0e4e34aba238b8e86246aef2943da7a1409248f4ae7bf91c5266c802a.png" src="../../_images/98a38ae0e4e34aba238b8e86246aef2943da7a1409248f4ae7bf91c5266c802a.png" />
</div>
</div>
</section>
<section id="extract-sla-data-along-trackline-26">
<h3>2.6 Extract SLA data along trackline 26<a class="headerlink" href="#extract-sla-data-along-trackline-26" title="Link to this heading">#</a></h3>
<p>At each time step, we will determine the SLA values along track 26 using interpolation, effectively converting 3D SLA data into 2D.</p>
<p>Initially, we will create a new DataSet called <code class="docutils literal notranslate"><span class="pre">ds_TL26</span></code> with dimensions ‘latitude’ and ‘time’. Notably, ‘longitude’ is aligned with ‘latitude’, making this a line data rather than grid data. For details, check “Section 2.3.3 Dataset with aligined coordinates (advanced)” in Xarray lesson. We will start by populating this area with NaN values. Subsequently, we will fill it with SLA data interpolated from the <code class="docutils literal notranslate"><span class="pre">ds</span></code> dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create coordinates for the four labels</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span>
<span class="n">latitudes</span><span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># latitude values </span>
<span class="n">longitudes</span><span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># longitude values </span>

<span class="c1"># Create a 4D Numpy Array representing values  for a 2x3x4x5 grid</span>
<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">latitudes</span><span class="p">))</span>
<span class="n">sla</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="c1">#sea surface anomoly [m]</span>

<span class="c1"># Create a DataArray with zos values</span>
<span class="n">ds_TL26</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;sla&#39;</span><span class="p">:</span> <span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">),</span> <span class="n">sla</span><span class="p">)},</span> <span class="c1">#sla values and its dimensions   </span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">latitudes</span><span class="p">})</span> <span class="c1">#Coordinates</span>

<span class="c1"># Data long data with dim lat data for records</span>
<span class="n">ds_TL26</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">longitudes</span><span class="p">)</span>

<span class="c1"># Add metadata to the DataArray</span>
<span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Long Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sea_surface_anomoly&#39;</span>
<span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Short Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sla&#39;</span>
<span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span>
<span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sea surface anomoly along trackline 26 &quot;</span>

<span class="c1"># Displaying DataSet with labeled dimensions and coordinates, and metadata</span>
<span class="n">display</span><span class="p">(</span><span class="n">ds_TL26</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 296kB
Dimensions:    (time: 364, latitude: 100)
Coordinates:
  * time       (time) datetime64[ns] 3kB 1993-02-15 1993-03-15 ... 2023-05-15
  * latitude   (latitude) float64 800B 28.4 28.36 28.31 ... 23.98 23.93 23.89
    longitude  (latitude) float64 800B 274.2 274.2 274.3 ... 276.3 276.3 276.4
Data variables:
    sla        (time, latitude) float64 291kB nan nan nan nan ... nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-13e5a0eb-47b9-4981-bb87-11e2b1c111a8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-13e5a0eb-47b9-4981-bb87-11e2b1c111a8' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 364</li><li><span class='xr-has-index'>latitude</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-bfa35982-5449-4861-9cb6-cff93880ba97' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bfa35982-5449-4861-9cb6-cff93880ba97' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-15 ... 2023-05-15</div><input id='attrs-70226bd9-78d1-44e3-988e-47c5abf7e7c2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70226bd9-78d1-44e3-988e-47c5abf7e7c2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f62056f6-bba6-42ba-b564-cd81cfff75a7' class='xr-var-data-in' type='checkbox'><label for='data-f62056f6-bba6-42ba-b564-cd81cfff75a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-15T00:00:00.000000000&#x27;, &#x27;1993-03-15T00:00:00.000000000&#x27;,
       &#x27;1993-04-15T00:00:00.000000000&#x27;, ..., &#x27;2023-03-15T00:00:00.000000000&#x27;,
       &#x27;2023-04-15T00:00:00.000000000&#x27;, &#x27;2023-05-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>28.4 28.36 28.31 ... 23.93 23.89</div><input id='attrs-07fb8dfc-fabb-424a-a35a-c73d819ce62c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-07fb8dfc-fabb-424a-a35a-c73d819ce62c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b753705b-fd43-40d3-8b3d-89a4fa19bc22' class='xr-var-data-in' type='checkbox'><label for='data-b753705b-fd43-40d3-8b3d-89a4fa19bc22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([28.403128, 28.357508, 28.311888, 28.266268, 28.220648, 28.175028,
       28.129408, 28.083787, 28.038167, 27.992547, 27.946927, 27.901307,
       27.855687, 27.810067, 27.764447, 27.718826, 27.673206, 27.627586,
       27.581966, 27.536346, 27.490726, 27.445106, 27.399485, 27.353865,
       27.308245, 27.262625, 27.217005, 27.171385, 27.125765, 27.080144,
       27.034524, 26.988904, 26.943284, 26.897664, 26.852044, 26.806424,
       26.760804, 26.715183, 26.669563, 26.623943, 26.578323, 26.532703,
       26.487083, 26.441463, 26.395842, 26.350222, 26.304602, 26.258982,
       26.213362, 26.167742, 26.122122, 26.076502, 26.030881, 25.985261,
       25.939641, 25.894021, 25.848401, 25.802781, 25.757161, 25.71154 ,
       25.66592 , 25.6203  , 25.57468 , 25.52906 , 25.48344 , 25.43782 ,
       25.3922  , 25.346579, 25.300959, 25.255339, 25.209719, 25.164099,
       25.118479, 25.072859, 25.027238, 24.981618, 24.935998, 24.890378,
       24.844758, 24.799138, 24.753518, 24.707897, 24.662277, 24.616657,
       24.571037, 24.525417, 24.479797, 24.434177, 24.388557, 24.342936,
       24.297316, 24.251696, 24.206076, 24.160456, 24.114836, 24.069216,
       24.023595, 23.977975, 23.932355, 23.886735])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>274.2 274.2 274.3 ... 276.3 276.4</div><input id='attrs-2e2c6423-9707-4677-b440-7749e9ab6bd1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2e2c6423-9707-4677-b440-7749e9ab6bd1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5db2da26-6f24-4a74-82fc-024000bb4671' class='xr-var-data-in' type='checkbox'><label for='data-5db2da26-6f24-4a74-82fc-024000bb4671' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([274.22750215, 274.24903708, 274.270572  , 274.29210693,
       274.31364185, 274.33517677, 274.3567117 , 274.37824662,
       274.39978155, 274.42131647, 274.44285139, 274.46438632,
       274.48592124, 274.50745617, 274.52899109, 274.55052602,
       274.57206094, 274.59359586, 274.61513079, 274.63666571,
       274.65820064, 274.67973556, 274.70127048, 274.72280541,
       274.74434033, 274.76587526, 274.78741018, 274.80894511,
       274.83048003, 274.85201495, 274.87354988, 274.8950848 ,
       274.91661973, 274.93815465, 274.95968957, 274.9812245 ,
       275.00275942, 275.02429435, 275.04582927, 275.06736419,
       275.08889912, 275.11043404, 275.13196897, 275.15350389,
       275.17503882, 275.19657374, 275.21810866, 275.23964359,
       275.26117851, 275.28271344, 275.30424836, 275.32578328,
       275.34731821, 275.36885313, 275.39038806, 275.41192298,
       275.4334579 , 275.45499283, 275.47652775, 275.49806268,
       275.5195976 , 275.54113253, 275.56266745, 275.58420237,
       275.6057373 , 275.62727222, 275.64880715, 275.67034207,
       275.69187699, 275.71341192, 275.73494684, 275.75648177,
       275.77801669, 275.79955161, 275.82108654, 275.84262146,
       275.86415639, 275.88569131, 275.90722624, 275.92876116,
       275.95029608, 275.97183101, 275.99336593, 276.01490086,
       276.03643578, 276.0579707 , 276.07950563, 276.10104055,
       276.12257548, 276.1441104 , 276.16564533, 276.18718025,
       276.20871517, 276.2302501 , 276.25178502, 276.27331995,
       276.29485487, 276.31638979, 276.33792472, 276.35945964])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7043f1bb-3478-4467-8e85-662af9627136' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7043f1bb-3478-4467-8e85-662af9627136' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sla</span></div><div class='xr-var-dims'>(time, latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-6c4fdba2-8a65-4d8a-8e3c-7ada318e6ecf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c4fdba2-8a65-4d8a-8e3c-7ada318e6ecf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb4a6769-2b99-4cd4-a9b9-bd8131407726' class='xr-var-data-in' type='checkbox'><label for='data-bb4a6769-2b99-4cd4-a9b9-bd8131407726' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Long Name :</span></dt><dd>sea_surface_anomoly</dd><dt><span>Short Name :</span></dt><dd>sla</dd><dt><span>Units :</span></dt><dd>meters</dd><dt><span>Description :</span></dt><dd>Sea surface anomoly along trackline 26 </dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6a673fb2-29fc-45c7-a50e-751abcae89e2' class='xr-section-summary-in' type='checkbox'  ><label for='section-6a673fb2-29fc-45c7-a50e-751abcae89e2' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-63bcb5be-13e6-484d-a898-76a63ee57bb0' class='xr-index-data-in' type='checkbox'/><label for='index-63bcb5be-13e6-484d-a898-76a63ee57bb0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-15&#x27;, &#x27;1993-03-15&#x27;, &#x27;1993-04-15&#x27;, &#x27;1993-05-15&#x27;,
               &#x27;1993-06-15&#x27;, &#x27;1993-07-15&#x27;, &#x27;1993-08-15&#x27;, &#x27;1993-09-15&#x27;,
               &#x27;1993-10-15&#x27;, &#x27;1993-11-15&#x27;,
               ...
               &#x27;2022-08-15&#x27;, &#x27;2022-09-15&#x27;, &#x27;2022-10-15&#x27;, &#x27;2022-11-15&#x27;,
               &#x27;2022-12-15&#x27;, &#x27;2023-01-15&#x27;, &#x27;2023-02-15&#x27;, &#x27;2023-03-15&#x27;,
               &#x27;2023-04-15&#x27;, &#x27;2023-05-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=364, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-37c25ec5-5894-4f1f-8a24-bb5cd3dfac57' class='xr-index-data-in' type='checkbox'/><label for='index-37c25ec5-5894-4f1f-8a24-bb5cd3dfac57' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.40312839118132, 28.357508256688767, 28.311888122196216,
       28.266267987703664, 28.220647853211112,  28.17502771871856,
        28.12940758422601, 28.083787449733457, 28.038167315240905,
       27.992547180748353,   27.9469270462558,  27.90130691176325,
       27.855686777270694, 27.810066642778143,  27.76444650828559,
        27.71882637379304, 27.673206239300487, 27.627586104807936,
       27.581965970315384, 27.536345835822832,  27.49072570133028,
        27.44510556683773, 27.399485432345177, 27.353865297852625,
       27.308245163360073,  27.26262502886752,  27.21700489437497,
       27.171384759882418, 27.125764625389866, 27.080144490897315,
       27.034524356404763,  26.98890422191221,  26.94328408741966,
       26.897663952927108, 26.852043818434556, 26.806423683942004,
       26.760803549449452, 26.715183414956897, 26.669563280464345,
       26.623943145971793,  26.57832301147924,  26.53270287698669,
       26.487082742494138, 26.441462608001586, 26.395842473509035,
       26.350222339016483,  26.30460220452393,  26.25898207003138,
       26.213361935538828, 26.167741801046276, 26.122121666553724,
       26.076501532061172,  26.03088139756862,  25.98526126307607,
       25.939641128583517, 25.894020994090965, 25.848400859598414,
       25.802780725105862,  25.75716059061331,  25.71154045612076,
       25.665920321628207, 25.620300187135655, 25.574680052643103,
        25.52905991815055, 25.483439783657996, 25.437819649165444,
       25.392199514672892,  25.34657938018034,  25.30095924568779,
       25.255339111195237, 25.209718976702685, 25.164098842210134,
       25.118478707717582,  25.07285857322503,  25.02723843873248,
       24.981618304239927, 24.935998169747375, 24.890378035254823,
        24.84475790076227,  24.79913776626972, 24.753517631777168,
       24.707897497284616, 24.662277362792064, 24.616657228299513,
        24.57103709380696,  24.52541695931441, 24.479796824821857,
       24.434176690329302,  24.38855655583675,   24.3429364213442,
       24.297316286851647, 24.251696152359095, 24.206076017866543,
        24.16045588337399,  24.11483574888144, 24.069215614388888,
       24.023595479896336, 23.977975345403785, 23.932355210911233,
        23.88673507641868],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a457597c-db18-4dd7-a4ad-72707fa98b4d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a457597c-db18-4dd7-a4ad-72707fa98b4d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Next, we will populate <code class="docutils literal notranslate"><span class="pre">ds_TL26</span></code> with SLA data interpolated from the <code class="docutils literal notranslate"><span class="pre">ds</span></code> dataset by leveraging broadcasting. While we have not covered broadcasting, this example will help you to understand how powerful broadcasting is.</p>
<p>Although you could fill <code class="docutils literal notranslate"><span class="pre">ds_TL26</span></code> with data using a for-loop, this approach would be highly computationally intensive. Imagine looping 364 (number of longitudes) x 100 (number of time steps) times and carrying out interpolation in each iteration!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can create a grid of coordinates for which you want to interpolate values</span>
<span class="n">time_coords</span> <span class="o">=</span> <span class="n">ds_TL26</span><span class="o">.</span><span class="n">time</span>
<span class="n">latitude_coords</span> <span class="o">=</span> <span class="n">ds_TL26</span><span class="o">.</span><span class="n">latitude</span>
<span class="n">longitude_coords</span> <span class="o">=</span> <span class="n">ds_TL26</span><span class="o">.</span><span class="n">longitude</span>

<span class="c1"># Use meshgrid to create a full grid of (time, latitude, longitude)</span>
<span class="n">time_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">,</span> <span class="n">lon_grid</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">time_coords</span><span class="p">,</span> <span class="n">latitude_coords</span><span class="p">,</span> <span class="n">longitude_coords</span><span class="p">)</span>

<span class="c1"># Interpolate using the interp method over the entire grid</span>
<span class="n">interpolated_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_grid</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="n">lat_grid</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="n">lon_grid</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="c1"># Now interpolated_ds contains the interpolated values for the entire grid</span>
<span class="c1"># Assuming that the original shape of ds_TL26.sla is compatible, you can assign the values directly</span>
<span class="n">ds_TL26</span><span class="p">[</span><span class="s1">&#39;sla&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolated_ds</span>

<span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;sla&#x27; (time: 364, latitude: 100)&gt; Size: 291kB
array([[-0.04606196, -0.04382741, -0.04098129, ..., -0.18760819,
        -0.20198027, -0.21718859],
       [-0.07241661, -0.07066914, -0.06829647, ..., -0.20055153,
        -0.20169734, -0.20318583],
       [-0.03172363, -0.02991171, -0.02928312, ..., -0.16815929,
        -0.1697745 , -0.17070123],
       ...,
       [ 0.09914508,  0.1030116 ,  0.10520716, ..., -0.01598656,
        -0.02282683, -0.02975827],
       [ 0.09877273,  0.10183734,  0.10362421, ..., -0.03444734,
        -0.04470912, -0.05566252],
       [ 0.08704669,  0.0877758 ,  0.08854079, ...,  0.28771283,
         0.30058475,  0.31296625]])
Coordinates:
  * time       (time) datetime64[ns] 3kB 1993-02-15 1993-03-15 ... 2023-05-15
  * latitude   (latitude) float64 800B 28.4 28.36 28.31 ... 23.98 23.93 23.89
    longitude  (latitude) float64 800B 274.2 274.2 274.3 ... 276.3 276.3 276.4
Attributes:
    cell_methods:   time: mean within years
    grid_mapping:   crs
    long_name:      Averaged Sea Level Anomalies 1993/02
    standard_name:  sea_surface_height_above_sea_level
    units:          m</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'sla'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 364</li><li><span class='xr-has-index'>latitude</span>: 100</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-885faba5-93c1-4663-a2a4-766db9670014' class='xr-array-in' type='checkbox' checked><label for='section-885faba5-93c1-4663-a2a4-766db9670014' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.04606 -0.04383 -0.04098 -0.038 ... 0.2744 0.2877 0.3006 0.313</span></div><div class='xr-array-data'><pre>array([[-0.04606196, -0.04382741, -0.04098129, ..., -0.18760819,
        -0.20198027, -0.21718859],
       [-0.07241661, -0.07066914, -0.06829647, ..., -0.20055153,
        -0.20169734, -0.20318583],
       [-0.03172363, -0.02991171, -0.02928312, ..., -0.16815929,
        -0.1697745 , -0.17070123],
       ...,
       [ 0.09914508,  0.1030116 ,  0.10520716, ..., -0.01598656,
        -0.02282683, -0.02975827],
       [ 0.09877273,  0.10183734,  0.10362421, ..., -0.03444734,
        -0.04470912, -0.05566252],
       [ 0.08704669,  0.0877758 ,  0.08854079, ...,  0.28771283,
         0.30058475,  0.31296625]])</pre></div></div></li><li class='xr-section-item'><input id='section-280b3e19-7f8f-4359-a813-5d8cbdfa5177' class='xr-section-summary-in' type='checkbox'  checked><label for='section-280b3e19-7f8f-4359-a813-5d8cbdfa5177' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-15 ... 2023-05-15</div><input id='attrs-a9abb043-b4c2-4a96-b5d5-234df9fc106f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9abb043-b4c2-4a96-b5d5-234df9fc106f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f33470d-e15c-49d6-bbfa-501e923b0bac' class='xr-var-data-in' type='checkbox'><label for='data-6f33470d-e15c-49d6-bbfa-501e923b0bac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-15T00:00:00.000000000&#x27;, &#x27;1993-03-15T00:00:00.000000000&#x27;,
       &#x27;1993-04-15T00:00:00.000000000&#x27;, ..., &#x27;2023-03-15T00:00:00.000000000&#x27;,
       &#x27;2023-04-15T00:00:00.000000000&#x27;, &#x27;2023-05-15T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>28.4 28.36 28.31 ... 23.93 23.89</div><input id='attrs-19da5ea8-98fc-4622-8623-d85d2acd2ab6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-19da5ea8-98fc-4622-8623-d85d2acd2ab6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-58a5c74c-9671-47c8-9779-8a4a0a566139' class='xr-var-data-in' type='checkbox'><label for='data-58a5c74c-9671-47c8-9779-8a4a0a566139' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([28.403128, 28.357508, 28.311888, 28.266268, 28.220648, 28.175028,
       28.129408, 28.083787, 28.038167, 27.992547, 27.946927, 27.901307,
       27.855687, 27.810067, 27.764447, 27.718826, 27.673206, 27.627586,
       27.581966, 27.536346, 27.490726, 27.445106, 27.399485, 27.353865,
       27.308245, 27.262625, 27.217005, 27.171385, 27.125765, 27.080144,
       27.034524, 26.988904, 26.943284, 26.897664, 26.852044, 26.806424,
       26.760804, 26.715183, 26.669563, 26.623943, 26.578323, 26.532703,
       26.487083, 26.441463, 26.395842, 26.350222, 26.304602, 26.258982,
       26.213362, 26.167742, 26.122122, 26.076502, 26.030881, 25.985261,
       25.939641, 25.894021, 25.848401, 25.802781, 25.757161, 25.71154 ,
       25.66592 , 25.6203  , 25.57468 , 25.52906 , 25.48344 , 25.43782 ,
       25.3922  , 25.346579, 25.300959, 25.255339, 25.209719, 25.164099,
       25.118479, 25.072859, 25.027238, 24.981618, 24.935998, 24.890378,
       24.844758, 24.799138, 24.753518, 24.707897, 24.662277, 24.616657,
       24.571037, 24.525417, 24.479797, 24.434177, 24.388557, 24.342936,
       24.297316, 24.251696, 24.206076, 24.160456, 24.114836, 24.069216,
       24.023595, 23.977975, 23.932355, 23.886735])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>274.2 274.2 274.3 ... 276.3 276.4</div><input id='attrs-e6f975a3-43f4-4182-b1ff-61a789bd161c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6f975a3-43f4-4182-b1ff-61a789bd161c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2d18c36-6064-4e44-bc77-ae45ecbba395' class='xr-var-data-in' type='checkbox'><label for='data-b2d18c36-6064-4e44-bc77-ae45ecbba395' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([274.22750215, 274.24903708, 274.270572  , 274.29210693,
       274.31364185, 274.33517677, 274.3567117 , 274.37824662,
       274.39978155, 274.42131647, 274.44285139, 274.46438632,
       274.48592124, 274.50745617, 274.52899109, 274.55052602,
       274.57206094, 274.59359586, 274.61513079, 274.63666571,
       274.65820064, 274.67973556, 274.70127048, 274.72280541,
       274.74434033, 274.76587526, 274.78741018, 274.80894511,
       274.83048003, 274.85201495, 274.87354988, 274.8950848 ,
       274.91661973, 274.93815465, 274.95968957, 274.9812245 ,
       275.00275942, 275.02429435, 275.04582927, 275.06736419,
       275.08889912, 275.11043404, 275.13196897, 275.15350389,
       275.17503882, 275.19657374, 275.21810866, 275.23964359,
       275.26117851, 275.28271344, 275.30424836, 275.32578328,
       275.34731821, 275.36885313, 275.39038806, 275.41192298,
       275.4334579 , 275.45499283, 275.47652775, 275.49806268,
       275.5195976 , 275.54113253, 275.56266745, 275.58420237,
       275.6057373 , 275.62727222, 275.64880715, 275.67034207,
       275.69187699, 275.71341192, 275.73494684, 275.75648177,
       275.77801669, 275.79955161, 275.82108654, 275.84262146,
       275.86415639, 275.88569131, 275.90722624, 275.92876116,
       275.95029608, 275.97183101, 275.99336593, 276.01490086,
       276.03643578, 276.0579707 , 276.07950563, 276.10104055,
       276.12257548, 276.1441104 , 276.16564533, 276.18718025,
       276.20871517, 276.2302501 , 276.25178502, 276.27331995,
       276.29485487, 276.31638979, 276.33792472, 276.35945964])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-216aba7b-ba99-4c6b-8f67-977708eaa3e1' class='xr-section-summary-in' type='checkbox'  ><label for='section-216aba7b-ba99-4c6b-8f67-977708eaa3e1' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e7159e80-4b0a-4775-ba3d-e14343a590ba' class='xr-index-data-in' type='checkbox'/><label for='index-e7159e80-4b0a-4775-ba3d-e14343a590ba' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-15&#x27;, &#x27;1993-03-15&#x27;, &#x27;1993-04-15&#x27;, &#x27;1993-05-15&#x27;,
               &#x27;1993-06-15&#x27;, &#x27;1993-07-15&#x27;, &#x27;1993-08-15&#x27;, &#x27;1993-09-15&#x27;,
               &#x27;1993-10-15&#x27;, &#x27;1993-11-15&#x27;,
               ...
               &#x27;2022-08-15&#x27;, &#x27;2022-09-15&#x27;, &#x27;2022-10-15&#x27;, &#x27;2022-11-15&#x27;,
               &#x27;2022-12-15&#x27;, &#x27;2023-01-15&#x27;, &#x27;2023-02-15&#x27;, &#x27;2023-03-15&#x27;,
               &#x27;2023-04-15&#x27;, &#x27;2023-05-15&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=364, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e8b26be9-ab50-42b8-aae4-04cce3902845' class='xr-index-data-in' type='checkbox'/><label for='index-e8b26be9-ab50-42b8-aae4-04cce3902845' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.40312839118132, 28.357508256688767, 28.311888122196216,
       28.266267987703664, 28.220647853211112,  28.17502771871856,
        28.12940758422601, 28.083787449733457, 28.038167315240905,
       27.992547180748353,   27.9469270462558,  27.90130691176325,
       27.855686777270694, 27.810066642778143,  27.76444650828559,
        27.71882637379304, 27.673206239300487, 27.627586104807936,
       27.581965970315384, 27.536345835822832,  27.49072570133028,
        27.44510556683773, 27.399485432345177, 27.353865297852625,
       27.308245163360073,  27.26262502886752,  27.21700489437497,
       27.171384759882418, 27.125764625389866, 27.080144490897315,
       27.034524356404763,  26.98890422191221,  26.94328408741966,
       26.897663952927108, 26.852043818434556, 26.806423683942004,
       26.760803549449452, 26.715183414956897, 26.669563280464345,
       26.623943145971793,  26.57832301147924,  26.53270287698669,
       26.487082742494138, 26.441462608001586, 26.395842473509035,
       26.350222339016483,  26.30460220452393,  26.25898207003138,
       26.213361935538828, 26.167741801046276, 26.122121666553724,
       26.076501532061172,  26.03088139756862,  25.98526126307607,
       25.939641128583517, 25.894020994090965, 25.848400859598414,
       25.802780725105862,  25.75716059061331,  25.71154045612076,
       25.665920321628207, 25.620300187135655, 25.574680052643103,
        25.52905991815055, 25.483439783657996, 25.437819649165444,
       25.392199514672892,  25.34657938018034,  25.30095924568779,
       25.255339111195237, 25.209718976702685, 25.164098842210134,
       25.118478707717582,  25.07285857322503,  25.02723843873248,
       24.981618304239927, 24.935998169747375, 24.890378035254823,
        24.84475790076227,  24.79913776626972, 24.753517631777168,
       24.707897497284616, 24.662277362792064, 24.616657228299513,
        24.57103709380696,  24.52541695931441, 24.479796824821857,
       24.434176690329302,  24.38855655583675,   24.3429364213442,
       24.297316286851647, 24.251696152359095, 24.206076017866543,
        24.16045588337399,  24.11483574888144, 24.069215614388888,
       24.023595479896336, 23.977975345403785, 23.932355210911233,
        23.88673507641868],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-db3b6e7b-3f0a-4af0-adf6-39d9331384df' class='xr-section-summary-in' type='checkbox'  checked><label for='section-db3b6e7b-3f0a-4af0-adf6-39d9331384df' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean within years</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Averaged Sea Level Anomalies 1993/02</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="plot-sla-data-along-trackline-26">
<h3>2.7 Plot SLA data along trackline 26<a class="headerlink" href="#plot-sla-data-along-trackline-26" title="Link to this heading">#</a></h3>
<p>Now let us plot SLA values along trackine 26 for all time steps. We have convert 3d to 2d that can be visualized. Let us see if we can reproduce Figure 4 in <a class="reference external" href="https://doi.org/10.1016/j.hal.2014.04.010">Weisberg et al., 2014</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grid of time and latitude values for contour plot</span>
<span class="n">lat_grid</span><span class="p">,</span> <span class="n">time_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ds_TL26</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span><span class="n">ds_TL26</span><span class="o">.</span><span class="n">time</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">lat_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="p">)</span>

<span class="c1"># Create a Figure and Axes object</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Create the contour plot</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">time_grid</span><span class="p">,</span><span class="n">lat_grid</span><span class="p">,</span> <span class="n">ds_TL26</span><span class="o">.</span><span class="n">sla</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Anomaly (cm)&#39;</span><span class="p">)</span>

<span class="c1"># Set labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (first day of year)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_title(&#39;Sea Level Anomaly&#39;)</span>

<span class="c1"># Format x-axis tick labels to display only last two digits of the year</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>

<span class="c1"># Set x-axis major locator and formatter to show ticks and labels for every year</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%y&#39;</span><span class="p">))</span>  <span class="c1"># Use &#39;%y&#39; to display only the last two digits of the year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(364, 100) (364, 100) &lt;xarray.DataArray &#39;sla&#39; (time: 364, latitude: 100)&gt; Size: 291kB
array([[-0.04606196, -0.04382741, -0.04098129, ..., -0.18760819,
        -0.20198027, -0.21718859],
       [-0.07241661, -0.07066914, -0.06829647, ..., -0.20055153,
        -0.20169734, -0.20318583],
       [-0.03172363, -0.02991171, -0.02928312, ..., -0.16815929,
        -0.1697745 , -0.17070123],
       ...,
       [ 0.09914508,  0.1030116 ,  0.10520716, ..., -0.01598656,
        -0.02282683, -0.02975827],
       [ 0.09877273,  0.10183734,  0.10362421, ..., -0.03444734,
        -0.04470912, -0.05566252],
       [ 0.08704669,  0.0877758 ,  0.08854079, ...,  0.28771283,
         0.30058475,  0.31296625]])
Coordinates:
  * time       (time) datetime64[ns] 3kB 1993-02-15 1993-03-15 ... 2023-05-15
  * latitude   (latitude) float64 800B 28.4 28.36 28.31 ... 23.98 23.93 23.89
    longitude  (latitude) float64 800B 274.2 274.2 274.3 ... 276.3 276.3 276.4
Attributes:
    cell_methods:   time: mean within years
    grid_mapping:   crs
    long_name:      Averaged Sea Level Anomalies 1993/02
    standard_name:  sea_surface_height_above_sea_level
    units:          m
</pre></div>
</div>
<img alt="../../_images/a94db9e7f80e5fbddb045b607511dead3df2318d46d28ca19a8a54f32cf37453.png" src="../../_images/a94db9e7f80e5fbddb045b607511dead3df2318d46d28ca19a8a54f32cf37453.png" />
</div>
</div>
</section>
</section>
<section id="exploring-k-brevis-data">
<h2>3. Exploring K. brevis data<a class="headerlink" href="#exploring-k-brevis-data" title="Link to this heading">#</a></h2>
<p>Red tides are caused by Karenia brevis harmful algae blooms. For Karenia brevis cell count data, you can use the <a class="reference external" href="https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc:0120767">current dataset</a> of Physical and biological data collected along the Texas, Mississippi, Alabama, and Florida Gulf coasts in the Gulf of Mexico as part of the Harmful Algal BloomS Observing System from 1953-08-19 to 2023-07-06 (NCEI Accession 0120767). For direct data download, you can use this <a class="reference external" href="https://www.nodc.noaa.gov/archive/arc0069/0120767/7.7/data/0-data/habsos_20230714.csv">data link</a> and this <a class="reference external" href="https://www.nodc.noaa.gov/archive/arc0069/0120767/7.7/data/0-data/Support%20Documents/">data documentation link</a>.  Alternatively, FWRI documents Karenia brevis blooms from 1953 to the present. The dataset has more than 200,000 records is updated daily. To request this dataset email: <a class="reference external" href="mailto:HABdata&#37;&#52;&#48;MyFWC&#46;com">HABdata<span>&#64;</span>MyFWC<span>&#46;</span>com</a>. To learn more about this data, check the <a class="reference external" href="https://myfwc.com/research/redtide/statewide/">FWRI  Red Tide  Red Tide Current Status</a>.</p>
<section id="extract-k-brevis-data-for-west-florida-shielf">
<h3>3.1 Extract K. brevis data for West Florida shielf<a class="headerlink" href="#extract-k-brevis-data-for-west-florida-shielf" title="Link to this heading">#</a></h3>
<p>We will conduct our analysis along the West Florida shielf covering from Tampa Bay and Charlotte Harbor estuary. For Tampa Bay, we restrict the K. brevis measurements from 27° N to 28° N and 85° W to coast. For Charlotte Harbor estuary, we restrict the K. brevis measurements from 25.5° N to less than 27° N and 85° W to coast. For each time step, which  is one week, we will take spatial average and thus convert our daily 3d K brevis cell count data to a weekly 1d data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read a csv file with Pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/habsos_20230714.csv&#39;</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Select column names that you need for your analysis (e.g., &#39;LATITUDE&#39;, &#39;LONGITUDE&#39;, &#39;SAMPLE_DATE&#39;, &#39;CELLCOUNT&#39;, etc.) </span>
<span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;STATE_ID&#39;</span><span class="p">,</span><span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">,</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMPLE_DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;CELLCOUNT&#39;</span><span class="p">]</span>

<span class="c1"># Filter the DataFrame to include only the selected columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">selected_columns</span><span class="p">]</span>

<span class="c1"># Create a new column &#39;region&#39; with default value &#39;Other&#39;</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Other&#39;</span>

<span class="c1"># Mask for dicing: Define mask for Tampa Bay region based on latitude and longitude values</span>
<span class="n">tampa_bay_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">27</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">28</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LONGITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">85</span><span class="p">)</span>

<span class="c1"># Assign value &#39;Tampa Bay&#39; to rows matching Tampa Bay mask </span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tampa_bay_mask</span><span class="p">,</span> <span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Tampa Bay&#39;</span>

<span class="c1"># Mask for decing: Define mask for Charlotte Harbor estuary region  based on latitude and longitude values</span>
<span class="n">charlotte_harbor_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">25.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LATITUDE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">27</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;LONGITUDE&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">85</span><span class="p">)</span>

<span class="c1"># Assign value &#39;Charlotte Harbor&#39; to rows matching Charlotte Harbor mask</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">charlotte_harbor_mask</span><span class="p">,</span> <span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Charlotte Harbor&#39;</span>

<span class="c1"># Convert the &quot;SAMPLE_DATE&quot; column to datetime format using pd.to_datetime()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SAMPLE_DATE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SAMPLE_DATE&#39;</span><span class="p">])</span>

<span class="c1"># Set the &quot;SAMPLE_DATE&quot; column as the index of your DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;SAMPLE_DATE&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Sort index (optional step)</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATE_ID</th>
      <th>DESCRIPTION</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>CELLCOUNT</th>
      <th>REGION</th>
    </tr>
    <tr>
      <th>SAMPLE_DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1953-08-19 00:00:00</th>
      <td>FL</td>
      <td>Tom Adams Bridge (Lemon Bay)</td>
      <td>26.93450</td>
      <td>-82.3535</td>
      <td>116000</td>
      <td>Charlotte Harbor</td>
    </tr>
    <tr>
      <th>1953-08-26 00:00:00</th>
      <td>FL</td>
      <td>Cortez Bridge</td>
      <td>27.46840</td>
      <td>-82.6937</td>
      <td>178000</td>
      <td>Tampa Bay</td>
    </tr>
    <tr>
      <th>1953-08-26 00:00:00</th>
      <td>FL</td>
      <td>Naples Pier</td>
      <td>26.13163</td>
      <td>-81.8063</td>
      <td>0</td>
      <td>Charlotte Harbor</td>
    </tr>
    <tr>
      <th>1953-08-26 00:00:00</th>
      <td>FL</td>
      <td>Piney Point; Lee County</td>
      <td>26.53340</td>
      <td>-81.9796</td>
      <td>0</td>
      <td>Charlotte Harbor</td>
    </tr>
    <tr>
      <th>1953-09-03 00:00:00</th>
      <td>FL</td>
      <td>Sarasota Bay; 3 mi North of bridge</td>
      <td>27.37750</td>
      <td>-82.5708</td>
      <td>1732000</td>
      <td>Tampa Bay</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2023-07-05 16:08:00</th>
      <td>AL</td>
      <td>Dauphin Island Public Beach</td>
      <td>30.24780</td>
      <td>-88.1272</td>
      <td>0</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>2023-07-05 16:11:00</th>
      <td>AL</td>
      <td>Cotton Bayou</td>
      <td>30.26940</td>
      <td>-87.5820</td>
      <td>0</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>2023-07-05 16:27:00</th>
      <td>AL</td>
      <td>Florida Point A</td>
      <td>30.26620</td>
      <td>-87.5501</td>
      <td>0</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>2023-07-05 16:45:00</th>
      <td>AL</td>
      <td>Dauphin Island East End</td>
      <td>30.24640</td>
      <td>-88.0776</td>
      <td>0</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>2023-07-06 16:06:00</th>
      <td>AL</td>
      <td>Bear Point</td>
      <td>30.30880</td>
      <td>-87.5268</td>
      <td>0</td>
      <td>Other</td>
    </tr>
  </tbody>
</table>
<p>205552 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="transform-3d-daily-k-brevis-data-to-1d-weekly-data">
<h3>3.2 Transform 3d daily K. brevis data to 1d weekly data<a class="headerlink" href="#transform-3d-daily-k-brevis-data-to-1d-weekly-data" title="Link to this heading">#</a></h3>
<p>For each time step that is one week, let us take the spatial average to convert our daily 3d K brevis cell count data to a weekly 1d data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Get rows for charlotte harbor region</span>
<span class="c1">#For these rows, find the mean cellcount per week for the study period </span>
<span class="n">charlotte_harbor_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Charlotte Harbor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Charlotte Harbor data&#39;</span><span class="p">,</span> <span class="n">charlotte_harbor_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">charlotte_harbor_data</span> <span class="o">=</span> <span class="n">charlotte_harbor_data</span><span class="p">[</span><span class="s1">&#39;CELLCOUNT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Charlotte Harbor weekly cell count data&#39;</span><span class="p">,</span> <span class="n">charlotte_harbor_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">#Get rows for tampa bay region </span>
<span class="c1">#For these rows find the maximum cellcount per week for the study period </span>
<span class="n">tampa_bay_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;Tampa Bay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tampa Bay data&#39;</span><span class="p">,</span> <span class="n">tampa_bay_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">tampa_bay_data</span> <span class="o">=</span> <span class="n">tampa_bay_data</span><span class="p">[</span><span class="s1">&#39;CELLCOUNT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tampa Bay weekly cell count data&#39;</span><span class="p">,</span> <span class="n">tampa_bay_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">#Get rows for West FL region </span>
<span class="c1">#For these rows find the maximum cellcount per week for the study period </span>
<span class="n">mask</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;Tampa Bay&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;REGION&#39;</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;Charlotte Harbor&#39;</span><span class="p">)</span>
<span class="n">west_FL_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;West FL data:&#39;</span><span class="p">,</span> <span class="n">west_FL_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">west_FL_data</span> <span class="o">=</span> <span class="n">west_FL_data</span><span class="p">[</span><span class="s1">&#39;CELLCOUNT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;West FL weekly cell count data:&#39;</span><span class="p">,</span> <span class="n">west_FL_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Charlotte Harbor data (61186, 6)
Charlotte Harbor weekly cell count data (3646,)
Tampa Bay data (89214, 6)
Tampa Bay weekly cell count data (3645,)
West FL data: (150400, 6)
West FL weekly cell count data: (3646,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-weekly-k-brevis-data">
<h3>3.3 Plot weekly K. brevis data<a class="headerlink" href="#plot-weekly-k-brevis-data" title="Link to this heading">#</a></h3>
<p>We can now plot the weekly 1d K. brevis cell count data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Calculate the minimum and maximum values of the &#39;time&#39; column in &#39;da&#39;</span>
<span class="n">min_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 
<span class="n">max_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span><span class="p">)</span>
    
<span class="c1"># Plot west_FL_data from min_time to max_time</span>
<span class="n">KB_data</span><span class="o">=</span><span class="n">west_FL_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_time</span><span class="p">:</span><span class="n">max_time</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KB_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">KB_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">KB_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;West FL&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;West FL Data&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis and y-axis limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Set x-axis major locator and formatter to show ticks and labels for every year</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

<span class="c1"># Set x-axis major locator and formatter to show ticks and labels for every year with two digits</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%y&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1993-02-15 00:00:00 2023-05-15 00:00:00
SAMPLE_DATE
1993-02-21   NaN
Freq: W-SUN, Name: CELLCOUNT, dtype: float64
SAMPLE_DATE
2023-05-14    2620.213115
Freq: W-SUN, Name: CELLCOUNT, dtype: float64
</pre></div>
</div>
<img alt="../../_images/4b8cd1a82c1749c80b4404e3b386bb0c699d066912c88338078dfaea6fb941b6.png" src="../../_images/4b8cd1a82c1749c80b4404e3b386bb0c699d066912c88338078dfaea6fb941b6.png" />
</div>
</div>
</section>
</section>
<section id="transform-sla-and-k-brevis-to-prepare-data-for-analysis">
<h2>4. Transform SLA and K. brevis to prepare data for analysis<a class="headerlink" href="#transform-sla-and-k-brevis-to-prepare-data-for-analysis" title="Link to this heading">#</a></h2>
<section id="temporal-resolution-alignment-of-sla-and-k-brevis-data">
<h3>4.1 Temporal resolution alignment of SLA and k. brevis data<a class="headerlink" href="#temporal-resolution-alignment-of-sla-and-k-brevis-data" title="Link to this heading">#</a></h3>
<p>We have weekly red tide data and monthly SLA data. We will need to aggregate or interpolate one of the datasets so that both series have the same temporal resolution. We 2d sla data with shape (364, 100). Let use do weekly interpolation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new time coordinate with weekly frequency</span>
<span class="n">weekly_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

<span class="c1"># Interpolate the DataArray to weekly values</span>
<span class="n">ds_TL26_HR</span> <span class="o">=</span> <span class="n">ds_TL26</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">weekly_dates</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Plot and display the new high resolution (HR) dataset</span>
<span class="n">ds_TL26_HR</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">ds_TL26_HR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
Dimensions:    (time: 1578, latitude: 100)
Coordinates:
  * latitude   (latitude) float64 800B 28.4 28.36 28.31 ... 23.98 23.93 23.89
    longitude  (latitude) float64 800B 274.2 274.2 274.3 ... 276.3 276.3 276.4
  * time       (time) datetime64[ns] 13kB 1993-02-21 1993-02-28 ... 2023-05-14
Data variables:
    sla        (time, latitude) float64 1MB -0.05171 -0.04958 ... 0.2891 0.3007</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cc4d1bca-6a6a-46d2-b466-14a294b7a4c7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cc4d1bca-6a6a-46d2-b466-14a294b7a4c7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1578</li><li><span class='xr-has-index'>latitude</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e4ffa953-401e-49da-bb1a-fc4aa04fc49b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e4ffa953-401e-49da-bb1a-fc4aa04fc49b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>28.4 28.36 28.31 ... 23.93 23.89</div><input id='attrs-ec59a133-da6b-4f46-9634-9b4a340d1cd4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec59a133-da6b-4f46-9634-9b4a340d1cd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-536179b1-8af8-4c90-8e0a-f3df30eb9bfa' class='xr-var-data-in' type='checkbox'><label for='data-536179b1-8af8-4c90-8e0a-f3df30eb9bfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([28.403128, 28.357508, 28.311888, 28.266268, 28.220648, 28.175028,
       28.129408, 28.083787, 28.038167, 27.992547, 27.946927, 27.901307,
       27.855687, 27.810067, 27.764447, 27.718826, 27.673206, 27.627586,
       27.581966, 27.536346, 27.490726, 27.445106, 27.399485, 27.353865,
       27.308245, 27.262625, 27.217005, 27.171385, 27.125765, 27.080144,
       27.034524, 26.988904, 26.943284, 26.897664, 26.852044, 26.806424,
       26.760804, 26.715183, 26.669563, 26.623943, 26.578323, 26.532703,
       26.487083, 26.441463, 26.395842, 26.350222, 26.304602, 26.258982,
       26.213362, 26.167742, 26.122122, 26.076502, 26.030881, 25.985261,
       25.939641, 25.894021, 25.848401, 25.802781, 25.757161, 25.71154 ,
       25.66592 , 25.6203  , 25.57468 , 25.52906 , 25.48344 , 25.43782 ,
       25.3922  , 25.346579, 25.300959, 25.255339, 25.209719, 25.164099,
       25.118479, 25.072859, 25.027238, 24.981618, 24.935998, 24.890378,
       24.844758, 24.799138, 24.753518, 24.707897, 24.662277, 24.616657,
       24.571037, 24.525417, 24.479797, 24.434177, 24.388557, 24.342936,
       24.297316, 24.251696, 24.206076, 24.160456, 24.114836, 24.069216,
       24.023595, 23.977975, 23.932355, 23.886735])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>274.2 274.2 274.3 ... 276.3 276.4</div><input id='attrs-64e93c57-39c7-46fc-98ba-aa886dd1b420' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64e93c57-39c7-46fc-98ba-aa886dd1b420' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bba78c12-6d8e-49b5-a4e4-f8e9ccc09ff1' class='xr-var-data-in' type='checkbox'><label for='data-bba78c12-6d8e-49b5-a4e4-f8e9ccc09ff1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([274.22750215, 274.24903708, 274.270572  , 274.29210693,
       274.31364185, 274.33517677, 274.3567117 , 274.37824662,
       274.39978155, 274.42131647, 274.44285139, 274.46438632,
       274.48592124, 274.50745617, 274.52899109, 274.55052602,
       274.57206094, 274.59359586, 274.61513079, 274.63666571,
       274.65820064, 274.67973556, 274.70127048, 274.72280541,
       274.74434033, 274.76587526, 274.78741018, 274.80894511,
       274.83048003, 274.85201495, 274.87354988, 274.8950848 ,
       274.91661973, 274.93815465, 274.95968957, 274.9812245 ,
       275.00275942, 275.02429435, 275.04582927, 275.06736419,
       275.08889912, 275.11043404, 275.13196897, 275.15350389,
       275.17503882, 275.19657374, 275.21810866, 275.23964359,
       275.26117851, 275.28271344, 275.30424836, 275.32578328,
       275.34731821, 275.36885313, 275.39038806, 275.41192298,
       275.4334579 , 275.45499283, 275.47652775, 275.49806268,
       275.5195976 , 275.54113253, 275.56266745, 275.58420237,
       275.6057373 , 275.62727222, 275.64880715, 275.67034207,
       275.69187699, 275.71341192, 275.73494684, 275.75648177,
       275.77801669, 275.79955161, 275.82108654, 275.84262146,
       275.86415639, 275.88569131, 275.90722624, 275.92876116,
       275.95029608, 275.97183101, 275.99336593, 276.01490086,
       276.03643578, 276.0579707 , 276.07950563, 276.10104055,
       276.12257548, 276.1441104 , 276.16564533, 276.18718025,
       276.20871517, 276.2302501 , 276.25178502, 276.27331995,
       276.29485487, 276.31638979, 276.33792472, 276.35945964])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-21 ... 2023-05-14</div><input id='attrs-76d619af-8821-423f-9098-172b9ecc5d92' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-76d619af-8821-423f-9098-172b9ecc5d92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef1785d9-b61a-4ec2-a369-9d5c345787d6' class='xr-var-data-in' type='checkbox'><label for='data-ef1785d9-b61a-4ec2-a369-9d5c345787d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-21T00:00:00.000000000&#x27;, &#x27;1993-02-28T00:00:00.000000000&#x27;,
       &#x27;1993-03-07T00:00:00.000000000&#x27;, ..., &#x27;2023-04-30T00:00:00.000000000&#x27;,
       &#x27;2023-05-07T00:00:00.000000000&#x27;, &#x27;2023-05-14T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f30d8e4a-dde8-4bf6-977f-72a641600e3d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f30d8e4a-dde8-4bf6-977f-72a641600e3d' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sla</span></div><div class='xr-var-dims'>(time, latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.05171 -0.04958 ... 0.2891 0.3007</div><input id='attrs-bbfcc59d-4f26-4038-8a1b-702648ab0326' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bbfcc59d-4f26-4038-8a1b-702648ab0326' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-236a1b35-8ce1-493e-824b-a3cb6aebb1c6' class='xr-var-data-in' type='checkbox'><label for='data-236a1b35-8ce1-493e-824b-a3cb6aebb1c6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean within years</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Averaged Sea Level Anomalies 1993/02</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[-0.05170939, -0.04957921, -0.04683454, ..., -0.19038176,
        -0.20191964, -0.214188  ],
       [-0.05829805, -0.05628964, -0.05366334, ..., -0.1936176 ,
        -0.20184891, -0.21068731],
       [-0.06488671, -0.06300008, -0.06049213, ..., -0.19685343,
        -0.20177818, -0.20718662],
       ...,
       [ 0.09290971,  0.09480657,  0.0960825 , ...,  0.12663274,
         0.12793782,  0.12865187],
       [ 0.09017363,  0.09152555,  0.09256304, ...,  0.20180345,
         0.20850639,  0.21466525],
       [ 0.08743755,  0.08824452,  0.08904357, ...,  0.27697416,
         0.28907496,  0.30067863]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e2e30265-2f04-47db-a40a-b81ca621614d' class='xr-section-summary-in' type='checkbox'  ><label for='section-e2e30265-2f04-47db-a40a-b81ca621614d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4bed8f08-4d68-4f13-aa9a-4e672e64fc42' class='xr-index-data-in' type='checkbox'/><label for='index-4bed8f08-4d68-4f13-aa9a-4e672e64fc42' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.40312839118132, 28.357508256688767, 28.311888122196216,
       28.266267987703664, 28.220647853211112,  28.17502771871856,
        28.12940758422601, 28.083787449733457, 28.038167315240905,
       27.992547180748353,   27.9469270462558,  27.90130691176325,
       27.855686777270694, 27.810066642778143,  27.76444650828559,
        27.71882637379304, 27.673206239300487, 27.627586104807936,
       27.581965970315384, 27.536345835822832,  27.49072570133028,
        27.44510556683773, 27.399485432345177, 27.353865297852625,
       27.308245163360073,  27.26262502886752,  27.21700489437497,
       27.171384759882418, 27.125764625389866, 27.080144490897315,
       27.034524356404763,  26.98890422191221,  26.94328408741966,
       26.897663952927108, 26.852043818434556, 26.806423683942004,
       26.760803549449452, 26.715183414956897, 26.669563280464345,
       26.623943145971793,  26.57832301147924,  26.53270287698669,
       26.487082742494138, 26.441462608001586, 26.395842473509035,
       26.350222339016483,  26.30460220452393,  26.25898207003138,
       26.213361935538828, 26.167741801046276, 26.122121666553724,
       26.076501532061172,  26.03088139756862,  25.98526126307607,
       25.939641128583517, 25.894020994090965, 25.848400859598414,
       25.802780725105862,  25.75716059061331,  25.71154045612076,
       25.665920321628207, 25.620300187135655, 25.574680052643103,
        25.52905991815055, 25.483439783657996, 25.437819649165444,
       25.392199514672892,  25.34657938018034,  25.30095924568779,
       25.255339111195237, 25.209718976702685, 25.164098842210134,
       25.118478707717582,  25.07285857322503,  25.02723843873248,
       24.981618304239927, 24.935998169747375, 24.890378035254823,
        24.84475790076227,  24.79913776626972, 24.753517631777168,
       24.707897497284616, 24.662277362792064, 24.616657228299513,
        24.57103709380696,  24.52541695931441, 24.479796824821857,
       24.434176690329302,  24.38855655583675,   24.3429364213442,
       24.297316286851647, 24.251696152359095, 24.206076017866543,
        24.16045588337399,  24.11483574888144, 24.069215614388888,
       24.023595479896336, 23.977975345403785, 23.932355210911233,
        23.88673507641868],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-25aac635-8624-4588-afa9-0c35c8b8deb2' class='xr-index-data-in' type='checkbox'/><label for='index-25aac635-8624-4588-afa9-0c35c8b8deb2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-21&#x27;, &#x27;1993-02-28&#x27;, &#x27;1993-03-07&#x27;, &#x27;1993-03-14&#x27;,
               &#x27;1993-03-21&#x27;, &#x27;1993-03-28&#x27;, &#x27;1993-04-04&#x27;, &#x27;1993-04-11&#x27;,
               &#x27;1993-04-18&#x27;, &#x27;1993-04-25&#x27;,
               ...
               &#x27;2023-03-12&#x27;, &#x27;2023-03-19&#x27;, &#x27;2023-03-26&#x27;, &#x27;2023-04-02&#x27;,
               &#x27;2023-04-09&#x27;, &#x27;2023-04-16&#x27;, &#x27;2023-04-23&#x27;, &#x27;2023-04-30&#x27;,
               &#x27;2023-05-07&#x27;, &#x27;2023-05-14&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1578, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c7a9a1ef-1475-44f7-a828-69f5cf8b1921' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c7a9a1ef-1475-44f7-a828-69f5cf8b1921' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div><img alt="../../_images/74f2dace7f8af5650639ae5276074751e1d3e68486e3e4f4776ad00813b64ab9.png" src="../../_images/74f2dace7f8af5650639ae5276074751e1d3e68486e3e4f4776ad00813b64ab9.png" />
</div>
</div>
</section>
<section id="reduce-2d-time-series-of-sla-along-trackline-26-to-1d-time-series">
<h3>4.2 Reduce 2D time series of SLA along trackline-26 to 1d time series<a class="headerlink" href="#reduce-2d-time-series-of-sla-along-trackline-26-to-1d-time-series" title="Link to this heading">#</a></h3>
<p>For the SLA data, we have values along a line. To match it with K. brevis data, we need to take an average or use some other method to reduce the 2D data to a 1D time series that we can directly compare with the K brevis data.</p>
<p>For simplicy we will take the mean SLA values from the first latitude value along trackline 26 at around 23.95 to latitde value of 24.6. The latitude value of 24.6 was visually estimated. However, this step can be iterative until we can establish a good correlation between weekly time series of SLA along trackline 26 and weekly time series of k. brevis cell-count data along the west Florida shelf.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_TL26_HR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
Dimensions:    (time: 1578, latitude: 100)
Coordinates:
  * latitude   (latitude) float64 800B 28.4 28.36 28.31 ... 23.98 23.93 23.89
    longitude  (latitude) float64 800B 274.2 274.2 274.3 ... 276.3 276.3 276.4
  * time       (time) datetime64[ns] 13kB 1993-02-21 1993-02-28 ... 2023-05-14
Data variables:
    sla        (time, latitude) float64 1MB -0.05171 -0.04958 ... 0.2891 0.3007</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e882e367-039f-4f13-a564-b0fb99df912e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e882e367-039f-4f13-a564-b0fb99df912e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1578</li><li><span class='xr-has-index'>latitude</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-cda4ba6f-3d87-41cd-8d82-ff84251bd14f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cda4ba6f-3d87-41cd-8d82-ff84251bd14f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>28.4 28.36 28.31 ... 23.93 23.89</div><input id='attrs-8cf37e5c-d529-48a3-bf0f-7a8af24bfa59' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8cf37e5c-d529-48a3-bf0f-7a8af24bfa59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf45a4ad-051c-46ca-9e86-6c2ef659a41d' class='xr-var-data-in' type='checkbox'><label for='data-bf45a4ad-051c-46ca-9e86-6c2ef659a41d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([28.403128, 28.357508, 28.311888, 28.266268, 28.220648, 28.175028,
       28.129408, 28.083787, 28.038167, 27.992547, 27.946927, 27.901307,
       27.855687, 27.810067, 27.764447, 27.718826, 27.673206, 27.627586,
       27.581966, 27.536346, 27.490726, 27.445106, 27.399485, 27.353865,
       27.308245, 27.262625, 27.217005, 27.171385, 27.125765, 27.080144,
       27.034524, 26.988904, 26.943284, 26.897664, 26.852044, 26.806424,
       26.760804, 26.715183, 26.669563, 26.623943, 26.578323, 26.532703,
       26.487083, 26.441463, 26.395842, 26.350222, 26.304602, 26.258982,
       26.213362, 26.167742, 26.122122, 26.076502, 26.030881, 25.985261,
       25.939641, 25.894021, 25.848401, 25.802781, 25.757161, 25.71154 ,
       25.66592 , 25.6203  , 25.57468 , 25.52906 , 25.48344 , 25.43782 ,
       25.3922  , 25.346579, 25.300959, 25.255339, 25.209719, 25.164099,
       25.118479, 25.072859, 25.027238, 24.981618, 24.935998, 24.890378,
       24.844758, 24.799138, 24.753518, 24.707897, 24.662277, 24.616657,
       24.571037, 24.525417, 24.479797, 24.434177, 24.388557, 24.342936,
       24.297316, 24.251696, 24.206076, 24.160456, 24.114836, 24.069216,
       24.023595, 23.977975, 23.932355, 23.886735])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>274.2 274.2 274.3 ... 276.3 276.4</div><input id='attrs-ffaa6da0-c3be-4856-8ec9-da83839e2977' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ffaa6da0-c3be-4856-8ec9-da83839e2977' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74794645-1396-41de-b418-15cc5e203a88' class='xr-var-data-in' type='checkbox'><label for='data-74794645-1396-41de-b418-15cc5e203a88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([274.22750215, 274.24903708, 274.270572  , 274.29210693,
       274.31364185, 274.33517677, 274.3567117 , 274.37824662,
       274.39978155, 274.42131647, 274.44285139, 274.46438632,
       274.48592124, 274.50745617, 274.52899109, 274.55052602,
       274.57206094, 274.59359586, 274.61513079, 274.63666571,
       274.65820064, 274.67973556, 274.70127048, 274.72280541,
       274.74434033, 274.76587526, 274.78741018, 274.80894511,
       274.83048003, 274.85201495, 274.87354988, 274.8950848 ,
       274.91661973, 274.93815465, 274.95968957, 274.9812245 ,
       275.00275942, 275.02429435, 275.04582927, 275.06736419,
       275.08889912, 275.11043404, 275.13196897, 275.15350389,
       275.17503882, 275.19657374, 275.21810866, 275.23964359,
       275.26117851, 275.28271344, 275.30424836, 275.32578328,
       275.34731821, 275.36885313, 275.39038806, 275.41192298,
       275.4334579 , 275.45499283, 275.47652775, 275.49806268,
       275.5195976 , 275.54113253, 275.56266745, 275.58420237,
       275.6057373 , 275.62727222, 275.64880715, 275.67034207,
       275.69187699, 275.71341192, 275.73494684, 275.75648177,
       275.77801669, 275.79955161, 275.82108654, 275.84262146,
       275.86415639, 275.88569131, 275.90722624, 275.92876116,
       275.95029608, 275.97183101, 275.99336593, 276.01490086,
       276.03643578, 276.0579707 , 276.07950563, 276.10104055,
       276.12257548, 276.1441104 , 276.16564533, 276.18718025,
       276.20871517, 276.2302501 , 276.25178502, 276.27331995,
       276.29485487, 276.31638979, 276.33792472, 276.35945964])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-21 ... 2023-05-14</div><input id='attrs-a776765d-eebb-442b-9eb6-b78bb04497b8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a776765d-eebb-442b-9eb6-b78bb04497b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-966a2717-afee-477d-b60f-7c79bdff3063' class='xr-var-data-in' type='checkbox'><label for='data-966a2717-afee-477d-b60f-7c79bdff3063' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>climatology_bnds</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-21T00:00:00.000000000&#x27;, &#x27;1993-02-28T00:00:00.000000000&#x27;,
       &#x27;1993-03-07T00:00:00.000000000&#x27;, ..., &#x27;2023-04-30T00:00:00.000000000&#x27;,
       &#x27;2023-05-07T00:00:00.000000000&#x27;, &#x27;2023-05-14T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-758bbbbb-1748-44c3-932e-484724f21329' class='xr-section-summary-in' type='checkbox'  checked><label for='section-758bbbbb-1748-44c3-932e-484724f21329' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sla</span></div><div class='xr-var-dims'>(time, latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.05171 -0.04958 ... 0.2891 0.3007</div><input id='attrs-0d227864-be0a-4822-9b9e-bd58cf8bd3a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0d227864-be0a-4822-9b9e-bd58cf8bd3a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eeaabb32-9592-4a1d-9100-7d119df9f9b0' class='xr-var-data-in' type='checkbox'><label for='data-eeaabb32-9592-4a1d-9100-7d119df9f9b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean within years</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Averaged Sea Level Anomalies 1993/02</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_sea_level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([[-0.05170939, -0.04957921, -0.04683454, ..., -0.19038176,
        -0.20191964, -0.214188  ],
       [-0.05829805, -0.05628964, -0.05366334, ..., -0.1936176 ,
        -0.20184891, -0.21068731],
       [-0.06488671, -0.06300008, -0.06049213, ..., -0.19685343,
        -0.20177818, -0.20718662],
       ...,
       [ 0.09290971,  0.09480657,  0.0960825 , ...,  0.12663274,
         0.12793782,  0.12865187],
       [ 0.09017363,  0.09152555,  0.09256304, ...,  0.20180345,
         0.20850639,  0.21466525],
       [ 0.08743755,  0.08824452,  0.08904357, ...,  0.27697416,
         0.28907496,  0.30067863]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3d6b43ec-cb9f-48e6-a9d3-d1ef9f84a56b' class='xr-section-summary-in' type='checkbox'  ><label for='section-3d6b43ec-cb9f-48e6-a9d3-d1ef9f84a56b' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2f64ee86-fc8e-4b3a-a5f7-cffdc73f21e7' class='xr-index-data-in' type='checkbox'/><label for='index-2f64ee86-fc8e-4b3a-a5f7-cffdc73f21e7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 28.40312839118132, 28.357508256688767, 28.311888122196216,
       28.266267987703664, 28.220647853211112,  28.17502771871856,
        28.12940758422601, 28.083787449733457, 28.038167315240905,
       27.992547180748353,   27.9469270462558,  27.90130691176325,
       27.855686777270694, 27.810066642778143,  27.76444650828559,
        27.71882637379304, 27.673206239300487, 27.627586104807936,
       27.581965970315384, 27.536345835822832,  27.49072570133028,
        27.44510556683773, 27.399485432345177, 27.353865297852625,
       27.308245163360073,  27.26262502886752,  27.21700489437497,
       27.171384759882418, 27.125764625389866, 27.080144490897315,
       27.034524356404763,  26.98890422191221,  26.94328408741966,
       26.897663952927108, 26.852043818434556, 26.806423683942004,
       26.760803549449452, 26.715183414956897, 26.669563280464345,
       26.623943145971793,  26.57832301147924,  26.53270287698669,
       26.487082742494138, 26.441462608001586, 26.395842473509035,
       26.350222339016483,  26.30460220452393,  26.25898207003138,
       26.213361935538828, 26.167741801046276, 26.122121666553724,
       26.076501532061172,  26.03088139756862,  25.98526126307607,
       25.939641128583517, 25.894020994090965, 25.848400859598414,
       25.802780725105862,  25.75716059061331,  25.71154045612076,
       25.665920321628207, 25.620300187135655, 25.574680052643103,
        25.52905991815055, 25.483439783657996, 25.437819649165444,
       25.392199514672892,  25.34657938018034,  25.30095924568779,
       25.255339111195237, 25.209718976702685, 25.164098842210134,
       25.118478707717582,  25.07285857322503,  25.02723843873248,
       24.981618304239927, 24.935998169747375, 24.890378035254823,
        24.84475790076227,  24.79913776626972, 24.753517631777168,
       24.707897497284616, 24.662277362792064, 24.616657228299513,
        24.57103709380696,  24.52541695931441, 24.479796824821857,
       24.434176690329302,  24.38855655583675,   24.3429364213442,
       24.297316286851647, 24.251696152359095, 24.206076017866543,
        24.16045588337399,  24.11483574888144, 24.069215614388888,
       24.023595479896336, 23.977975345403785, 23.932355210911233,
        23.88673507641868],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b53671e8-9cdb-40a5-8710-e20a8b059f09' class='xr-index-data-in' type='checkbox'/><label for='index-b53671e8-9cdb-40a5-8710-e20a8b059f09' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1993-02-21&#x27;, &#x27;1993-02-28&#x27;, &#x27;1993-03-07&#x27;, &#x27;1993-03-14&#x27;,
               &#x27;1993-03-21&#x27;, &#x27;1993-03-28&#x27;, &#x27;1993-04-04&#x27;, &#x27;1993-04-11&#x27;,
               &#x27;1993-04-18&#x27;, &#x27;1993-04-25&#x27;,
               ...
               &#x27;2023-03-12&#x27;, &#x27;2023-03-19&#x27;, &#x27;2023-03-26&#x27;, &#x27;2023-04-02&#x27;,
               &#x27;2023-04-09&#x27;, &#x27;2023-04-16&#x27;, &#x27;2023-04-23&#x27;, &#x27;2023-04-30&#x27;,
               &#x27;2023-05-07&#x27;, &#x27;2023-05-14&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1578, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-afecbe33-9b49-4e37-b76d-cb506837511b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-afecbe33-9b49-4e37-b76d-cb506837511b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>To get the desired slice of latitudes from our <code class="docutils literal notranslate"><span class="pre">ds_TL26_HR</span></code> dataset, we can use the following approach:</p>
<ul class="simple">
<li><p>Find the index of the latitude value closest to our target value of 24.6 using the <code class="docutils literal notranslate"><span class="pre">numpy.argmin</span></code> function and the absolute difference between the latitude values and 26.</p></li>
<li><p>Use the index to slice the dataset along the latitude dimension.</p></li>
</ul>
<p>This approach will give you a subset of the dataset, <code class="docutils literal notranslate"><span class="pre">ds_TL26_HR_LowLat</span></code>, containing all latitudes from the minimum latitude up to and including the latitude closest to 24.6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the index of the latitude closest to target lat 24.8</span>
<span class="n">target_lat</span> <span class="o">=</span> <span class="mf">24.6</span>
<span class="n">idx_closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ds_TL26_HR</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">target_lat</span><span class="p">))</span>

<span class="c1"># Slice the dataset from the minimum latitude up to the index closest to 26</span>
<span class="n">ds_TL26_HR_LowLat</span> <span class="o">=</span> <span class="n">ds_TL26_HR</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">idx_closest</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_TL26_HR</span><span class="o">.</span><span class="n">latitude</span><span class="p">)))</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Low latitude starts from </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Low latitude ends at </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1"> (closet to target latitude of </span><span class="si">{</span><span class="n">target_lat</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1">#Plot low latitude slide</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">lat_grid</span><span class="p">,</span> <span class="n">time_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">time</span><span class="p">,)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">time_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">,</span> <span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">sla</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Anomaly (cm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (first day of year)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Low latitude starts from 23.887
Low latitude ends at 24.617 (closet to target latitude of 24.6)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Latitude&#39;)
</pre></div>
</div>
<img alt="../../_images/5f2c0450af3112ecea8471ab0fbf5296ead4a22dab0a67681235492d4d1b2d33.png" src="../../_images/5f2c0450af3112ecea8471ab0fbf5296ead4a22dab0a67681235492d4d1b2d33.png" />
</div>
</div>
<p>We can simple take the mean at each time step to convert the 2d SLA data in the above figure to 1d data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean of the variable &#39;sla&#39; along the &#39;latitude&#39; dimension in the DataSet &#39;ds&#39;</span>
<span class="n">ds_TL26_HR_LowLat_mean</span> <span class="o">=</span> <span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">sla</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1">#Visualize the 1d weekly SLA time series</span>
<span class="n">ds_TL26_HR_LowLat_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eb0f13d936ba9066ad15f57a7cbac29de88c35352a5c7c0ee81232c2249241ad.png" src="../../_images/eb0f13d936ba9066ad15f57a7cbac29de88c35352a5c7c0ee81232c2249241ad.png" />
</div>
</div>
<p>Let us plot both SLA and K. brevis data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a figure with two subplots sharing the x-axis</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>


<span class="c1"># First subplot</span>
<span class="c1"># Create the line plot</span>
<span class="n">ax_line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">KB_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;West FL&#39;</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;West FL Data&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis and y-axis limits</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Add gridlines to the plot</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis major locator and formatter to show ticks and labels for every year with two digits</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax_line</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%y&#39;</span><span class="p">))</span>


<span class="c1"># Second subplot</span>
<span class="c1"># Create a grid of time and latitude values for contour plot</span>
<span class="n">lat_grid_HR</span><span class="p">,</span> <span class="n">time_grid_HR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span><span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">time</span><span class="p">,)</span>

<span class="c1"># Create the contour plot</span>
<span class="n">ax_contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">ax_contour</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">time_grid_HR</span><span class="p">,</span> <span class="n">lat_grid_HR</span><span class="p">,</span> <span class="n">ds_TL26_HR_LowLat</span><span class="o">.</span><span class="n">sla</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>

<span class="c1"># Add gridlines to the plot</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set labels and title</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (first day of year)&#39;</span><span class="p">)</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis major locator and formatter to show ticks and labels for every year with two digits</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">()</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%y&#39;</span><span class="p">))</span>  <span class="c1"># Use &#39;%y&#39; to display only the last two digits of the year</span>

<span class="c1"># Hide x-axis labels on the top axis</span>
<span class="c1"># Hide y-axis labels on the right axis</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Set y-axis major locator and formatter to show ticks and labels for every 0.5</span>
<span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">23.5</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax_contour</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">))</span>


<span class="c1"># Add colorbar with decreased vertical distance</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Anomaly (cm)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/47539f9d244c4e3c46a6abd015324c0603e6344de390533fe41964e6f8de1335.png" src="../../_images/47539f9d244c4e3c46a6abd015324c0603e6344de390533fe41964e6f8de1335.png" />
</div>
</div>
<p>Here are the two time series together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot time series data in two subplots within the same figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot Kb_stationary data</span>
<span class="n">KB_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;K. brevis Data&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="c1"># Plot sla_stationary data</span>
<span class="n">ds_TL26_HR_LowLat_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SLA Data&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bae5808a9dff2a634356b158764fd23ff8f0131736a289c4de542a56889f613f.png" src="../../_images/bae5808a9dff2a634356b158764fd23ff8f0131736a289c4de542a56889f613f.png" />
</div>
</div>
</section>
<section id="additional-steps">
<h3>4.3 Additional steps<a class="headerlink" href="#additional-steps" title="Link to this heading">#</a></h3>
<p>Before we proceed with statstical analysis there could be additional considerations and steps that are method specific. For example, if we want perform cross-correlation analysis we would need to:</p>
<ul class="simple">
<li><p>Check if both time series are stationary. If they are not stationary, we may need to difference the series or transform them in some way to make them stationary.</p></li>
<li><p>Detrending the data helps remove any linear trends present, allowing us to focus on the anomalies in the data.</p></li>
<li><p>Series should be normalized, especially if they are in very different units or scales. This usually involves dividing by the standard deviation. We can do many more data preparation as needed.</p></li>
</ul>
<p>Here is an example of normalization</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize both series</span>
<span class="n">sla_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_TL26_HR_LowLat_mean</span> <span class="o">-</span> <span class="n">ds_TL26_HR_LowLat_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">ds_TL26_HR_LowLat_mean</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">red_tide_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">KB_data</span> <span class="o">-</span> <span class="n">KB_data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">KB_data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Create a single figure with two subplots for normalized data</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot normalized KB data</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">red_tide_norm</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">red_tide_norm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normalized KB Data&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized K. brevis Data&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="c1"># Plot normalized SLA data</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sla_norm</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">sla_norm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normalized SLA Data&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized SLA Data&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/785e81356c2772cc43099cd9be64f158833ce89f0d08d10fa791bf0d1c472772.png" src="../../_images/785e81356c2772cc43099cd9be64f158833ce89f0d08d10fa791bf0d1c472772.png" />
</div>
</div>
<p>Once we prepared your data, you can use statistical libraries like statsmodels to perform statstical analysis.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapters\9. Xarray and CartoPy for Labeled and Gridded N-dimensional Arrays"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="cartopy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lesson 28: CartoPy Basics</p>
      </div>
    </a>
    <a class="right-next"
       href="../10.%20Intro%20to%20Google%20Earth%20Engine/10.0-%20Intro%20to%20GEE.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Intro to Google Earth Engine</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-statement">1. Problem Statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-sla-data">2. Exploring SLA data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-global-data-optional">2.1 Download global data (<em>optional</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-and-save-gulf-of-mexico-data-optional">2.2 Select and save Gulf of Mexico data (<em>optional</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-display-data">2.3 Load and display data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-cooridnates-along-trackline-26">2.4 Generate cooridnates along trackline 26</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-trackline">2.5 Plot trackline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-sla-data-along-trackline-26">2.6 Extract SLA data along trackline 26</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-sla-data-along-trackline-26">2.7 Plot SLA data along trackline 26</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-k-brevis-data">3. Exploring K. brevis data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-k-brevis-data-for-west-florida-shielf">3.1 Extract K. brevis data for West Florida shielf</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-3d-daily-k-brevis-data-to-1d-weekly-data">3.2 Transform 3d daily K. brevis data to 1d weekly data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-weekly-k-brevis-data">3.3 Plot weekly K. brevis data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-sla-and-k-brevis-to-prepare-data-for-analysis">4. Transform SLA and K. brevis to prepare data for analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-resolution-alignment-of-sla-and-k-brevis-data">4.1 Temporal resolution alignment of SLA and k. brevis data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-2d-time-series-of-sla-along-trackline-26-to-1d-time-series">4.2 Reduce 2D time series of SLA along trackline-26 to 1d time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-steps">4.3 Additional steps</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ahmed Elshall & Thalia Valle
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>